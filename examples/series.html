---
layout: example
title: Series Chart
---

<div style="margin: auto; max-width: 1200px">
  <div id="test" class="ratio" style="--bs-aspect-ratio: 50%"></div>
  <button id="button1" type="button" class="btn btn-secondary">1</button>
  <button id="button2" type="button" class="btn btn-secondary">2</button>
  <button id="button3" type="button" class="btn btn-secondary">3</button>
</div>

<script type="text/javascript">
  const chartGroup = new dc.ChartGroup();
  const chart = new dc.SeriesChart('#test', chartGroup);
  let ndx, runDimension, runGroup;

  d3.csv('morley.csv').then(experiments => {
    ndx = crossfilter(experiments);
    runDimension = ndx.dimension(d => [+d.Expt, +d.Run]);
    runGroup = runDimension.group().reduceSum(d => +d.Speed);

    const repositionLegends = chart => {
      const legend = chart.legend();
      const left =
        (chart.effectiveWidth() - legend.legendWidth()) / 2 +
        chart.margins().left;
      const top = chart.effectiveHeight() - 50;
      legend.x(left).y(top);
    };

    chart
      .dataProvider(
        new dc.CFSimpleAdapter({
          dimension: runDimension,
          group: runGroup,
          valueAccessor: d => +d.value - 500,
        })
      )
      .configure({
        chartFunction: c =>
          new dc.LineChart(c, chartGroup).curve(d3.curveCardinal),
        brushOn: false,
        clipPadding: 10,
        elasticY: true,
        mouseZoomable: true,
        seriesAccessor: d => `Expt: ${d.key[0]}`,
        keyAccessor: d => +d.key[1],
      })
      .x(d3.scaleLinear().domain([0, 20]))
      .yAxisLabel('Measured Speed km/s')
      .xAxisLabel('Run')
      .legend(
        new dc.Legend()
          .itemHeight(13)
          .gap(5)
          .horizontal(1)
          .legendWidth(140)
          .itemWidth(70)
      )
      .on('preRender', repositionLegends)
      .on('preRedraw', repositionLegends);

    chart.yAxis().tickFormat(d => d3.format(',d')(d + 299500));
    chart.margins().left += 40;

    chartGroup.renderAll();
  });

  function updateData(file) {
    d3.csv(file).then(experiments => {
      ndx.remove(() => true);
      ndx.add(experiments);
      chartGroup.redrawAll();
    });
  }

  d3.select('#button1').on('click', () => updateData('morley.csv'));
  d3.select('#button2').on('click', () => updateData('morley2.csv'));
  d3.select('#button3').on('click', () => updateData('morley3.csv'));
</script>
