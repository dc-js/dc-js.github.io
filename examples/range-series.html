---
layout: example
title: A Series Chart as a Range Chart
---

<div style="margin: auto; max-width: 1200px">
  <p>
    This page demonstrates a line chart used as a rangeChart. You can zoom and
    pan the chart in the top using mouse. You can use brush the lower chart to
    select a range.
  </p>
  <p>
    This example also shows how to keep the legends always at the bottom center.
  </p>
  <div id="test" class="ratio" style="--bs-aspect-ratio: 50%"></div>
  <div id="test-overview" style="height: 100px"></div>
</div>

<script type="text/javascript">
  const chartGroup = new dc.ChartGroup();
  dc.constants.EVENT_DELAY = 0;

  const focusChart = new dc.SeriesChart('#test', chartGroup);
  const overviewChart = new dc.SeriesChart('#test-overview', chartGroup);
  let ndx, runDimension, runGroup;

  d3.csv('morley.csv').then(experiments => {
    ndx = crossfilter(experiments);
    runDimension = ndx.dimension(d => [+d.Expt, +d.Run]);
    runGroup = runDimension.group().reduceSum(d => +d.Speed);

    const repositionLegends = chart => {
      const legend = chart.legend();
      const left =
        (chart.effectiveWidth() - legend.legendWidth()) / 2 +
        chart.margins().left;
      const top = chart.effectiveHeight() - 50;
      legend.x(left).y(top);
    };

    focusChart
      .dataProvider(
        new dc.CFSimpleAdapter({
          dimension: runDimension,
          group: runGroup,
          valueAccessor: d => +d.value - 500,
        })
      )
      .configure({
        transitionDuration: 0,
        brushOn: false,
        autoFocus: true,
        yAxisPadding: '5%',
        elasticY: true,
        mouseZoomable: true,
        seriesAccessor: d => `Expt: ${d.key[0]}`,
        keyAccessor: d => +d.key[1],
        chartFunction: c =>
          new dc.LineChart(c, chartGroup)
            .configure({
              evadeDomainFilter: true,
            })
            .curve(d3.curveCardinal),
      })
      .x(d3.scaleLinear().domain([0, 20]))
      .yAxisLabel('Measured Speed km/s')
      .xAxisLabel('Run')
      .legend(
        new dc.Legend()
          .itemHeight(13)
          .gap(5)
          .horizontal(1)
          .legendWidth(140)
          .itemWidth(70)
      )
      .on('preRender', repositionLegends)
      .on('preRedraw', repositionLegends);

    focusChart.yAxis().tickFormat(d => d3.format(',d')(d + 299500));
    focusChart.margins().left += 40;

    overviewChart
      .dataProvider(
        new dc.CFSimpleAdapter({
          dimension: runDimension,
          group: runGroup,
          valueAccessor: d => +d.value - 500,
        })
      )
      .configure({
        minHeight: 20,
        transitionDuration: 0,
        chartFunction: c =>
          new dc.LineChart(c, chartGroup).curve(d3.curveCardinal),
        brushOn: true,
        clipPadding: 10,
        seriesAccessor: d => `Expt: ${d.key[0]}`,
        keyAccessor: d => +d.key[1],
      })
      .x(d3.scaleLinear().domain([0, 20]))
      .xAxisLabel('Run');
    overviewChart.margins().left += 50;

    chartGroup.renderAll();
  });
</script>
