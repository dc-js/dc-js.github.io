/*!
 *  dc 5.0.0-alpha0
 *  http://dc-js.github.io/dc.js/
 *  Copyright 2012-2022 Nick Zhu & the dc.js Developers
 *  https://github.com/dc-js/dc.js/blob/master/AUTHORS
 *
 *  Licensed under the Apache License, Version 2.0 (the "License");
 *  you may not use this file except in compliance with the License.
 *  You may obtain a copy of the License at
 *
 *      http://www.apache.org/licenses/LICENSE-2.0
 *
 *  Unless required by applicable law or agreed to in writing, software
 *  distributed under the License is distributed on an "AS IS" BASIS,
 *  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 *  See the License for the specific language governing permissions and
 *  limitations under the License.
 */

!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports,require("d3"),require("d3"),require("d3"),require("d3"),require("d3"),require("d3"),require("d3"),require("d3"),require("d3"),require("d3"),require("d3"),require("d3"),require("d3"),require("d3"),require("d3"),require("d3"),require("d3")):"function"==typeof define&&define.amd?define(["exports","d3","d3","d3","d3","d3","d3","d3","d3","d3","d3","d3","d3","d3","d3","d3","d3","d3"],e):e((t="undefined"!=typeof globalThis?globalThis:t||self).dc={},t.d3,t.d3,t.d3,t.d3,t.d3,t.d3,t.d3,t.d3,t.d3,t.d3,t.d3,t.d3,t.d3,t.d3,t.d3,t.d3,t.d3)}(this,(function(t,e,i,s,r,n,a,o,h,l,c,d,_,u,f,g,p,y){"use strict";class m extends Array{constructor(t){super(),this.filterType="HierarchyFilter";for(let e=0;e<t.length;e++)this[e]=t[e]}isFiltered(t){const e=this;if(!(e.length&&t&&t.length&&t.length>=e.length))return!1;for(let i=0;i<e.length;i++)if(t[i]!==e[i])return!1;return!0}serialize(){return[...this]}}class x extends Array{constructor(t,e){super(),this.filterType="RangedFilter",this[0]=t,this[1]=e}isFiltered(t){return t>=this[0]&&t<this[1]}serialize(){return[...this]}}class A extends Array{constructor(t){super(),this.filterType="RangedTwoDimensionalFilter";for(let e=0;e<t.length;e++)this[e]=t[e];t[0]instanceof Array?this.fromBottomLeft=[[Math.min(t[0][0],t[1][0]),Math.min(t[0][1],t[1][1])],[Math.max(t[0][0],t[1][0]),Math.max(t[0][1],t[1][1])]]:this.fromBottomLeft=[[t[0],-1/0],[t[1],1/0]]}isFiltered(t){let e,i;return t instanceof Array?(e=t[0],i=t[1]):(e=t,i=this.fromBottomLeft[0][1]),e>=this.fromBottomLeft[0][0]&&e<this.fromBottomLeft[1][0]&&i>=this.fromBottomLeft[0][1]&&i<this.fromBottomLeft[1][1]}serialize(){return[...this]}}class b extends Array{constructor(t){super(),this.filterType="TwoDimensionalFilter",this[0]=t[0],this[1]=t[1]}isFiltered(t){return t.length&&t.length===this.length&&t[0]===this[0]&&t[1]===this[1]}serialize(){return[...this]}}class v extends Error{}function C(t,e,i,s){return new(i||(i=Promise))((function(r,n){function a(t){try{h(s.next(t))}catch(t){n(t)}}function o(t){try{h(s.throw(t))}catch(t){n(t)}}function h(t){var e;t.done?r(t.value):(e=t.value,e instanceof i?e:new i((function(t){t(e)}))).then(a,o)}h((s=s.apply(t,e||[])).next())}))}const w={HierarchyFilter:t=>new m(t),RangedFilter:t=>new x(t[0],t[1]),RangedTwoDimensionalFilter:t=>new A(t),TwoDimensionalFilter:t=>new b(t)};class S{constructor(){this._filters=new Map,this._listenerChains=new Map,this._filterChangeListener=e.dispatch("filter-changed")}onFilterChange(t,e){this._filterChangeListener.on(`filter-changed.${t}`,e)}registerFilterListener(t){const e=t.storageKey;this._listenerChains.get(e)||this._listenerChains.set(e,[]);const i=Object.assign({},t);return this._listenerChains.get(e).push(i),i}deRegisterFilterListener(t,e){let i=this._listenerChains.get(t);i=i.filter((t=>t!==e)),this._listenerChains.set(t,i)}deRegisterAll(){this._filters=new Map,this._listenerChains=new Map}notifyListeners(t,e){const i=this._listenerChains.get(t);i.filter((t=>"function"==typeof t.onFiltersChanged)).forEach((t=>{t.onFiltersChanged(e)}));const s=i.map((t=>t.chartId));this._filterChangeListener.call("filter-changed",this,{chartIds:s,filters:this._filters.get(t)})}setFiltersFor(t,e){this._filters.set(t,e)}getFiltersFor(t){return this._filters.get(t)||this._filters.set(t,[]),this._filters.get(t)}resetFiltersAndNotify(t){this.setFiltersAndNotify(t,[])}setFiltersAndNotify(t,e){this.setFiltersFor(t,e);const i=this._listenerChains.get(t);i&&i[0]&&i[0].applyFilters(e),this.notifyListeners(t,e)}deserializeFiltersSetAndNotify(t,e){const i=this._deSerializeFilters(e.filterType,e.values);this.setFiltersAndNotify(t,i)}serialize({includeStorageKey:t}={}){return Array.from(this._listenerChains.values()).map((e=>{const i=e.find((t=>t.primaryChart));if(i){const e=this._filters.get(i.storageKey);if(e&&e.length>0){const s=this._serializeFilters(i.chartId,e);return t&&(s.storageKey=i.storageKey),s}}})).filter((t=>t))}restore(t){const e=Array.from(this._listenerChains.values()),i=new Map(t.map((t=>{const i=e.find((e=>e.find((e=>e.chartId===t.chartId)))),s=this._deSerializeFilters(t.filterType,t.values);return[i[0].storageKey,s]})));for(const t of this._listenerChains.keys()){const e=i.has(t)?i.get(t):[];this.setFiltersAndNotify(t,e)}}_serializeFilters(t,e){if("function"!=typeof e[0].isFiltered)return{chartId:t,filterType:"Simple",values:[...e]};const i=e;return{chartId:t,filterType:i[0].filterType,values:i.map((t=>t.serialize()))}}_deSerializeFilters(t,e){if("Simple"===t)return e;const i=w[t];return e.map((t=>i(t)))}}class L{constructor(){this._charts=[],this.filterStorage=new S}list(){return this._charts}has(t){return this._charts.includes(t)}register(t){this._charts.push(t)}deregister(t){"function"==typeof t.dispose&&t.dispose(),this._charts=this._charts.filter((e=>e!==t))}clear(){this._charts=[]}renderAll(){return C(this,void 0,void 0,(function*(){"function"==typeof this.beforeRenderAll&&(yield this.beforeRenderAll());for(const t of this._charts)t.render();"function"==typeof this.renderlet&&this.renderlet()}))}redrawAll(){return C(this,void 0,void 0,(function*(){"function"==typeof this.beforeRedrawAll&&(yield this.beforeRedrawAll());for(const t of this._charts)t.redraw();"function"==typeof this.renderlet&&this.renderlet()}))}filterAll(){for(const t of this._charts)t.filterAll()}refocusAll(){for(const t of this._charts)t.focus&&t.focus()}}const R={CHART_CLASS:"dc-chart",DEBUG_GROUP_CLASS:"debug",STACK_CLASS:"stack",DESELECTED_CLASS:"deselected",SELECTED_CLASS:"selected",NODE_INDEX_NAME:"__index__",GROUP_INDEX_NAME:"__group_index__",DEFAULT_CHART_GROUP:"__default_chart_group__",EVENT_DELAY:40,NEGLIGIBLE_NUMBER:1e-10};const D=new class{constructor(){this._chartMap={}}chartGroup(t){return t||(t=R.DEFAULT_CHART_GROUP),this._chartMap[t]||(this._chartMap[t]=new L),this._chartMap[t]}has(t){for(const e in this._chartMap)if(this._chartMap.hasOwnProperty(e)&&this._chartMap[e].has(t))return!0;return!1}clear(t){if(t)this._chartMap[t]&&(this._chartMap[t].clear(),delete this._chartMap[t]);else{for(const t in this._chartMap)this._chartMap.hasOwnProperty(t)&&this._chartMap[t].clear();this._chartMap={}}}list(t){return this.chartGroup(t).list()}};class k{constructor(){this.enableDebugLog=!1,this._alreadyWarned={}}warn(t){return console&&(console.warn?console.warn(t):console.log&&console.log(t)),this}warnOnce(t){return this._alreadyWarned[t]||(this._alreadyWarned[t]=!0,F.warn(t)),this}debug(t){return this.enableDebugLog&&console&&(console.debug?console.debug(t):console.log&&console.log(t)),this}}const F=new k;class P{constructor(){this.floatFormat=s.format(".2f"),this._defaultColors=P._schemeCategory20c,this.dateFormat=i.timeFormat("%m/%d/%Y"),this.disableTransitions=!1}defaultColors(t){return arguments.length?(this._defaultColors=t,this):(this._defaultColors===P._schemeCategory20c&&F.warnOnce("You are using d3.schemeCategory20c, which has been removed in D3v5. See the explanation at https://github.com/d3/d3/blob/master/CHANGES.md#changes-in-d3-50. DC is using it for backward compatibility, however it will be changed in DCv3.1. You can change it by calling dc.config.defaultColors(newScheme). See https://github.com/d3/d3-scale-chromatic for some alternatives."),this._defaultColors)}}P._schemeCategory20c=["#3182bd","#6baed6","#9ecae1","#c6dbef","#e6550d","#fd8d3c","#fdae6b","#fdd0a2","#31a354","#74c476","#a1d99b","#c7e9c0","#756bb1","#9e9ac8","#bcbddc","#dadaeb","#636363","#969696","#bdbdbd","#d9d9d9"];const O=new P;function B(t,e,i,s){if(O.disableTransitions||e<=0)return t;let r=t.transition(s);return(e>=0||void 0!==e)&&(r=r.duration(e)),(i>=0||void 0!==i)&&(r=r.delay(i)),r}function $(t,e,i,s){return t?function(t){return B(t,e,i,s)}:function(t){return t}}function E(t){return t instanceof Object&&t.__dcFlag__&&!0}const T={current:null,trigger:void 0};T.trigger=function(t,e){e?(T.current=t,setTimeout((()=>{t===T.current&&t()}),e)):t()};class z extends Error{}const H=function(t,e){return function(i,s){return e.call(i,i[t],s)}};function M(t,e){return[...t].sort(((t,i)=>n.ascending(e(t),e(i))))}function N(t){let e=`${t}`;return t instanceof Date?e=O.dateFormat(t):"string"==typeof t?e=t:U(t)?e=O.floatFormat(t):V(t)&&(e=`${Math.round(t)}`),e}function G(t){return{second:r.timeSecond,minute:r.timeMinute,hour:r.timeHour,day:r.timeDay,week:r.timeWeek,month:r.timeMonth,year:r.timeYear}[t]}function Y(t,e,i){if("string"==typeof e&&(e=e.replace("%","")),t instanceof Date)return"string"==typeof e&&(e=+e),"millis"===i?new Date(t.getTime()+e):("function"!=typeof(i=i||r.timeDay)&&(i=G(i)),i.offset(t,e));if("string"==typeof e){const i=+e/100;return t>0?t*(1+i):t*(1-i)}return t+e}function I(t,e,i){if("string"==typeof e&&(e=e.replace("%","")),t instanceof Date)return"string"==typeof e&&(e=+e),"millis"===i?new Date(t.getTime()-e):("function"!=typeof(i=i||r.timeDay)&&(i=G(i)),i.offset(t,-e));if("string"==typeof e){const i=+e/100;return t<0?t*(1+i):t*(1-i)}return t-e}function W(t){return t===+t}function U(t){return t===+t&&t!==(0|t)}function V(t){return t===+t&&t===(0|t)}function X(t){return!W(t)||t<R.NEGLIGIBLE_NUMBER&&t>-R.NEGLIGIBLE_NUMBER}let q=0;function j(){return++q}function Z(t){return t.toLowerCase().replace(/[\s]/g,"_").replace(/[\.']/g,"")}function K(t,e,i){i=i||e;let s=t.select(e);return s.empty()&&(s=t.append(i)),s}function J(t){return W(+t)?+t:0}function Q(t,e){return!t&&!e||!(!t||!e)&&(t.length===e.length&&t.every(((t,i)=>t.valueOf()===e[i].valueOf())))}function tt(t,e){const i={key:"root",children:[]};for(let s=0;s<t.length;s++){const r=t[s],n=r.key,a=e(r);let o=i;for(let t=0;t<n.length;t++){const e=n.slice(0,t+1),i=o.children,s=n[t];let h;t+1<n.length?(h=et(i,s),void 0===h&&(h={key:s,children:[],path:e},i.push(h)),o=h):(h={key:s,value:a,data:r,path:e},i.push(h))}}return i}function et(t,e){for(let i=0;i<t.length;i++)if(t[i].key===e)return t[i]}function it(t,e){let i=t.length;if(i!==e.length)return!1;for(;i--;)if(t[i]!==e[i])return!1;return!0}function st(t){return t.map((t=>rt(t))).join(", ")}function rt(t){let e="";return null!=t&&(t instanceof Array?t.length>=2?e=`[${t.map((t=>N(t))).join(" -> ")}]`:t.length>=1&&(e=N(t[0])):e=N(t)),e}const nt=function(t,e){return Math.abs(e-t)},at=function(t,e){throw new Error("dc.units.ordinal should not be called - it is a placeholder")};class ot{getColor(t,e){}share(t){return this}}class ht extends ot{constructor(t){super(),this.getColor=t}}class lt extends ot{constructor(t){super(),this.colorScale=t}getColor(t,e){return this.colorScale(this.colorAccessor(t,e))}share(t){const e=new lt(this.colorScale);return e.colorAccessor=t,e}}class ct extends lt{constructor(t){super(a.scaleLinear().range(t).interpolate(o.interpolateHcl))}}class dt extends lt{constructor(t){super(a.scaleOrdinal().range(t))}}const _t=function(){let t=1,e=1,i=0;let s=null,r=Number,o=ut,c=ft,d=null,_=!1;let u=.3,f=.8,g=!1,p=!0,y=!1;function m(m){m.each((function(l,m){l=l.map(r).sort(n.ascending);const x=h.select(this),A=l.length;let b,v;if(0===A)return;const C=l.quartiles=c(l),w=o&&o.call(this,l,m),S=w&&w.map((t=>l[t])),L=w?n.range(0,w[0]).concat(n.range(w[1]+1,A)):n.range(A);p?(b=l[0],v=l[A-1]):(b=l[w[0]],v=l[w[1]]);const R=n.range(w[0],w[1]+1),D=a.scaleLinear().domain(s&&s.call(this,l,m)||[b,v]).range([e,0]),k=this.__chart__||a.scaleLinear().domain([0,1/0]).range(D.range());this.__chart__=D;const F=x.selectAll("line.center").data(S?[S]:[]);F.enter().insert("line","rect").attr("class","center").attr("x1",t/2).attr("y1",(t=>k(t[0]))).attr("x2",t/2).attr("y2",(t=>k(t[1]))).style("opacity",1e-6).transition().duration(i).delay(0).style("opacity",1).attr("y1",(t=>D(t[0]))).attr("y2",(t=>D(t[1]))),F.transition().duration(i).delay(0).style("opacity",1).attr("x1",t/2).attr("x2",t/2).attr("y1",(t=>D(t[0]))).attr("y2",(t=>D(t[1]))),F.exit().transition().duration(i).delay(0).style("opacity",1e-6).attr("y1",(t=>D(t[0]))).attr("y2",(t=>D(t[1]))).remove();const P=x.selectAll("rect.box").data([C]);P.enter().append("rect").attr("class","box").attr("x",0).attr("y",(t=>k(t[2]))).attr("width",t).attr("height",(t=>k(t[0])-k(t[2]))).style("fill-opacity",_?.1:1).transition().duration(i).delay(0).attr("y",(t=>D(t[2]))).attr("height",(t=>D(t[0])-D(t[2]))),P.transition().duration(i).delay(0).attr("width",t).attr("y",(t=>D(t[2]))).attr("height",(t=>D(t[0])-D(t[2])));const O=x.selectAll("line.median").data([C[1]]);O.enter().append("line").attr("class","median").attr("x1",0).attr("y1",k).attr("x2",t).attr("y2",k).transition().duration(i).delay(0).attr("y1",D).attr("y2",D),O.transition().duration(i).delay(0).attr("x1",0).attr("x2",t).attr("y1",D).attr("y2",D);const B=x.selectAll("line.whisker").data(S||[]);if(B.enter().insert("line","circle, text").attr("class","whisker").attr("x1",0).attr("y1",k).attr("x2",t).attr("y2",k).style("opacity",1e-6).transition().duration(i).delay(0).attr("y1",D).attr("y2",D).style("opacity",1),B.transition().duration(i).delay(0).attr("x1",0).attr("x2",t).attr("y1",D).attr("y2",D).style("opacity",1),B.exit().transition().duration(i).delay(0).attr("y1",D).attr("y2",D).style("opacity",1e-6).remove(),p){const e=y?"outlierBold":"outlier",s=y?3:5,r=y?function(){return Math.floor(Math.random()*(t*f)+1+(t-t*f)/2)}:function(){return t/2},n=x.selectAll(`circle.${e}`).data(L,Number);n.enter().insert("circle","text").attr("class",e).attr("r",s).attr("cx",r).attr("cy",(t=>k(l[t]))).style("opacity",1e-6).transition().duration(i).delay(0).attr("cy",(t=>D(l[t]))).style("opacity",.6),g&&(n.selectAll("title").remove(),n.append("title").text((t=>l[t]))),n.transition().duration(i).delay(0).attr("cx",r).attr("cy",(t=>D(l[t]))).style("opacity",.6),n.exit().transition().duration(i).delay(0).attr("cy",0).style("opacity",1e-6).remove()}if(_){const e=x.selectAll("circle.data").data(R);e.enter().insert("circle","text").attr("class","data").attr("r",3).attr("cx",(()=>Math.floor(Math.random()*(t*f)+1+(t-t*f)/2))).attr("cy",(t=>k(l[t]))).style("opacity",1e-6).transition().duration(i).delay(0).attr("cy",(t=>D(l[t]))).style("opacity",u),g&&(e.selectAll("title").remove(),e.append("title").text((t=>l[t]))),e.transition().duration(i).delay(0).attr("cx",(()=>Math.floor(Math.random()*(t*f)+1+(t-t*f)/2))).attr("cy",(t=>D(l[t]))).style("opacity",u),e.exit().transition().duration(i).delay(0).attr("cy",0).style("opacity",1e-6).remove()}const $=d||D.tickFormat(8),E=x.selectAll("text.box").data(C);E.enter().append("text").attr("class","box").attr("dy",".3em").attr("dx",((t,e)=>1&e?6:-6)).attr("x",((e,i)=>1&i?t:0)).attr("y",k).attr("text-anchor",((t,e)=>1&e?"start":"end")).text($).transition().duration(i).delay(0).attr("y",D),E.transition().duration(i).delay(0).text($).attr("x",((e,i)=>1&i?t:0)).attr("y",D);const T=x.selectAll("text.whisker").data(S||[]);T.enter().append("text").attr("class","whisker").attr("dy",".3em").attr("dx",6).attr("x",t).attr("y",k).text($).style("opacity",1e-6).transition().duration(i).delay(0).attr("y",D).style("opacity",1),T.transition().duration(i).delay(0).text($).attr("x",t).attr("y",D).style("opacity",1),T.exit().transition().duration(i).delay(0).attr("y",D).style("opacity",1e-6).remove(),delete l.quartiles})),l.timerFlush()}return m.width=function(e){return arguments.length?(t=e,m):t},m.height=function(t){return arguments.length?(e=t,m):e},m.tickFormat=function(t){return arguments.length?(d=t,m):d},m.showOutliers=function(t){return arguments.length?(p=t,m):p},m.boldOutlier=function(t){return arguments.length?(y=t,m):y},m.renderDataPoints=function(t){return arguments.length?(_=t,m):_},m.renderTitle=function(t){return arguments.length?(g=t,m):g},m.dataOpacity=function(t){return arguments.length?(u=t,m):u},m.dataWidthPortion=function(t){return arguments.length?(f=t,m):f},m.duration=function(t){return arguments.length?(i=t,m):i},m.domain=function(t){return arguments.length?(s=null===t||"function"==typeof t?t:()=>t,m):s},m.value=function(t){return arguments.length?(r=t,m):r},m.whiskers=function(t){return arguments.length?(o=t,m):o},m.quartiles=function(t){return arguments.length?(c=t,m):c},m};function ut(t){return[0,t.length-1]}function ft(t){return[n.quantile(t,.25),n.quantile(t,.5),n.quantile(t,.75)]}class gt{constructor(){this._filters=[]}get filters(){return this._filters}set filters(t){this._filters=t}hasFilter(t){return null==t?this.filters.length>0:this.filters.some((e=>t<=e&&t>=e))}applyFilters(){}notifyListeners(t){}filter(t){return arguments.length?(null===t?this.resetFilters():t instanceof Array&&t[0]instanceof Array&&!t.isFiltered?t[0].forEach((t=>this.toggleFilter(t))):this.toggleFilter(t),this.applyFilters(),this.notifyListeners(t),this):this.filters.length>0?this.filters[0]:null}toggleFilter(t){this.hasFilter(t)?this.removeFilter(t):this.addFilter(t)}addFilter(t){this.filters.push(t)}removeFilter(t){this.filters=this.filters.filter((e=>!(t<=e&&t>=e)))}resetFilters(){this.filters=[]}dispose(){}}class pt extends gt{constructor(t={}){super(),this.configure(t)}configure(t){return this._conf=Object.assign(Object.assign({},this._conf),t),this}conf(){return this._conf}applyFilters(){this._conf.dimension&&this._conf.dimension.filter&&(0===this.filters.length?this._conf.dimension.filter(null):1!==this.filters.length||this.filters[0].isFiltered?1===this.filters.length&&"RangedFilter"===this.filters[0].filterType?this._conf.dimension.filterRange(this.filters[0]):this._conf.dimension.filterFunction((t=>{for(let e=0;e<this.filters.length;e++){const i=this.filters[e];if(i.isFiltered){if(i.isFiltered(t))return!0}else if(i<=t&&i>=t)return!0}return!1})):this._conf.dimension.filterExact(this.filters[0]))}}class yt extends pt{constructor(t={}){super(Object.assign({shareFilters:!0},t))}conf(){return super.conf()}configure(t){return super.configure(t),this._ensureListenerRegistered(),this}_ensureListenerRegistered(){if(!this._conf.filterStorage)return;const t=this._storageKey();if(this._listenerRegToken){if(this._listenerRegToken.storageKey===t)return;this._deRegisterListener()}this._listenerRegToken=this._conf.filterStorage.registerFilterListener({storageKey:t,onFiltersChanged:this._conf.onFiltersChanged,chartId:this._conf.chartId,primaryChart:this._conf.primaryChart,applyFilters:t=>this.applyFilters()})}_deRegisterListener(){this._conf.filterStorage.deRegisterFilterListener(this._listenerRegToken.storageKey,this._listenerRegToken),this._listenerRegToken=void 0}_storageKey(){return this._conf.shareFilters?this._conf.dimension:this}get filters(){return this._conf.filterStorage.getFiltersFor(this._storageKey())}set filters(t){this._conf.filterStorage.setFiltersFor(this._storageKey(),t)}notifyListeners(t){this._conf.filterStorage.notifyListeners(this._storageKey(),t)}dispose(){super.dispose(),this._listenerRegToken&&this._deRegisterListener()}}class mt extends yt{constructor(t={}){super(Object.assign({valueAccessor:t=>t.value,ordering:t=>t.key},t))}configure(t){return super.configure(t)}conf(){return super.conf()}data(){const t=this._conf.group.all();return t.map((t=>Object.assign({},t))),t.forEach((t=>{t._value=this._conf.valueAccessor(t)})),t}}class xt{constructor(t,i){this._anchor=void 0,this._root=void 0,this._svg=void 0,this._isChild=void 0,this.__dcFlag__=j().toString(),this._chartGroup=this._getChartGroup(i),this.anchor(t),this.configure({minWidth:200,minHeight:200,useViewBoxResizing:!1,filterPrinter:st,controlsUseVisibility:!1,transitionDuration:750,transitionDelay:0,commitHandler:void 0,keyAccessor:t=>t.key,label:t=>t.key,renderLabel:!1,renderTitle:!0,title:t=>`${this._conf.keyAccessor(t)}: ${t._value}`}),this.dataProvider(new mt),this._calculatedWidth=void 0,this._calculatedHeight=void 0,this._mandatoryAttributesList=[],this._listeners=e.dispatch("preRender","postRender","preRedraw","postRedraw","filtered","zoomed","renderlet","pretransition"),this._legend=void 0}dispose(){this._dataProvider&&this._dataProvider.dispose()}configure(t){return this._conf=Object.assign(Object.assign({},this._conf),t),this}conf(){return this._conf}dataProvider(t){return arguments.length?(this._dataProvider&&this._dataProvider.dispose(),this._dataProvider=t,this._dataProvider.configure({chartId:this.anchorName(),primaryChart:!this._isChild,filterStorage:this.chartGroup().filterStorage,onFiltersChanged:t=>this._filtersChanged(t)}),this):this._dataProvider}height(){return W(this.conf().height)?this.conf().height:this._calculatedHeight}width(){return W(this.conf().width)?this.conf().width:this._calculatedWidth}onResize(t){return t={width:n.max([t.width,this.conf().minWidth]),height:n.max([t.height,this.conf().minHeight])},this.conf().beforeResize&&this.conf().beforeResize(t),t}handleResize(t){this.withoutTransitions((()=>{this._calculatedWidth=t.width,this._calculatedHeight=t.height,this.redraw()}))}data(){return this._dataProvider.data()}_computeOrderedGroups(t){return M(t,this._dataProvider.conf().ordering)}filterAll(){return this.filter(null)}select(t){return this._root.select(t)}selectAll(t){return this._root?this._root.selectAll(t):null}anchor(t){if(!arguments.length)return this._anchor;if(E(t))this._anchor=t.anchor(),this._anchor.children&&(this._anchor=`#${t.anchorName()}`),this._root=t.root(),this._isChild=!0;else{if(!t)throw new v("parent must be defined");t.select&&t.classed?this._anchor=t.node():this._anchor=t,this._root=h.select(this._anchor),this._root.classed(R.CHART_CLASS,!0),this._chartGroup.register(this),this._isChild=!1}return this}_getChartGroup(t){return t&&"string"!=typeof t?t:D.chartGroup(t)}anchorName(){const t=this.anchor();if(t){if("string"==typeof t)return t.replace("#","");if(t.id)return t.id}return`dc-chart${this.chartID()}`}root(t){return arguments.length?(this._root=t,this):this._root}svg(t){return arguments.length?(this._svg=t,this):this._svg}resetSvg(){return this.select("svg").remove(),this.generateSvg()}sizeSvg(){this._svg&&(this._conf.useViewBoxResizing?this._svg.attr("viewBox")||this._svg.attr("viewBox",`0 0 ${this.width()} ${this.height()}`):this._svg.attr("width",this.width()).attr("height",this.height()))}generateSvg(){return this._svg=this.root().append("svg"),this.sizeSvg(),this._svg}turnOnControls(){if(this._root){const t=this._conf.controlsUseVisibility?"visibility":"display";this.selectAll(".reset").style(t,null),this.selectAll(".filter").text(this._conf.filterPrinter(this.filters())).style(t,null)}return this}turnOffControls(){if(this._root){const t=this._conf.controlsUseVisibility?"visibility":"display",e=this._conf.controlsUseVisibility?"hidden":"none";this.selectAll(".reset").style(t,e),this.selectAll(".filter").style(t,e).text(this.filter())}return this}_mandatoryAttributes(t){return arguments.length?(this._mandatoryAttributesList=t,this):this._mandatoryAttributesList}checkForMandatoryAttributes(t){if(!this[t]||!this[t]())throw new z(`Mandatory attribute chart.${t} is missing on chart[#${this.anchorName()}]`)}render(){const t=this.root()&&this.root().node();if(t){let{width:e,height:i}=this._calculateSize(t);this._calculatedWidth=e,this._calculatedHeight=i}return this._listeners.call("preRender",this,this),this._doRender(),this._legend&&this._legend.render(),this._activateRenderlets("postRender"),this._registerResizeObserver(t),this}_calculateSize(t){const e=t.getBoundingClientRect(),i=getComputedStyle(t),s=parseFloat(i.paddingLeft)+parseFloat(i.paddingRight),r=parseFloat(i.paddingTop)+parseFloat(i.paddingBottom),n=parseFloat(i.borderLeftWidth)+parseFloat(i.borderRightWidth),a=parseFloat(i.borderTopWidth)+parseFloat(i.borderBottomWidth),o=e.width-s-n,h=e.height-r-a;return this.onResize({width:o,height:h})}_registerResizeObserver(t){this._resizeObserver&&(this._resizeObserver.disconnect(),this._resizeObserver=null);let e=!0;t&&(W(this.conf().width)&&W(this.conf().height)||(this._resizeObserver=new ResizeObserver((t=>{if(e)e=!1;else{const e=this.onResize(t[0].contentRect);this.handleResize(e)}})),this._resizeObserver.observe(t)))}_activateRenderlets(t){this._listeners.call("pretransition",this,this),this._conf.transitionDuration>0&&this._svg?this._svg.transition().duration(this._conf.transitionDuration).delay(this._conf.transitionDelay).on("end",(()=>{this._listeners.call("renderlet",this,this),t&&this._listeners.call(t,this,this)})):(this._listeners.call("renderlet",this,this),t&&this._listeners.call(t,this,this))}redraw(){this.sizeSvg(),this._listeners.call("preRedraw",this,this);const t=this._doRedraw();return this._legend&&this._legend.render(),this._activateRenderlets("postRedraw"),t}redrawGroup(){return this._conf.commitHandler?this._conf.commitHandler(!1,((t,e)=>{t?console.log(t):this.chartGroup().redrawAll()})):this.chartGroup().redrawAll(),this}renderGroup(){return this._conf.commitHandler?this._conf.commitHandler(!1,((t,e)=>{t?console.log(t):this.chartGroup().renderAll()})):this.chartGroup().renderAll(),this}_invokeFilteredListener(t){void 0!==t&&this._listeners.call("filtered",this,this,t)}_invokeZoomedListener(){this._listeners.call("zoomed",this,this)}hasFilter(t){return this._dataProvider.hasFilter(t)}replaceFilter(t){return this._dataProvider.resetFilters(),this.filter(t),this}filter(t){return arguments.length?(this._dataProvider.filter(t),this):this._dataProvider.filter()}_filtersChanged(t){this._invokeFilteredListener(t),null!==this._root&&this.hasFilter()?this.turnOnControls():this.turnOffControls()}filters(){return this._dataProvider.filters}highlightSelected(t){h.select(t).classed(R.SELECTED_CLASS,!0),h.select(t).classed(R.DESELECTED_CLASS,!1)}fadeDeselected(t){h.select(t).classed(R.SELECTED_CLASS,!1),h.select(t).classed(R.DESELECTED_CLASS,!0)}resetHighlight(t){h.select(t).classed(R.SELECTED_CLASS,!1),h.select(t).classed(R.DESELECTED_CLASS,!1)}onClick(t,e){const i=this._conf.keyAccessor(t);T.trigger((()=>{this.filter(i),this.redrawGroup()}))}_doRender(){return this}_doRedraw(){return this}legendables(){return[]}legendHighlight(t){}legendReset(t){}legendToggle(t){}isLegendableHidden(t){return!1}chartGroup(t){return arguments.length?(this._isChild||this._chartGroup.deregister(this),this._chartGroup=this._getChartGroup(t),this._isChild||this._chartGroup.register(this),this):this._chartGroup}expireCache(){return this}legend(t){return arguments.length?(this._legend=t,this._legend.parent(this),this):this._legend}chartID(){return this.__dcFlag__}options(t){const e=["anchor","group","xAxisLabel","yAxisLabel","stack","title","point","getColor","overlayGeoJson"];for(const i in t)"function"==typeof this[i]?t[i]instanceof Array&&-1!==e.indexOf(i)?this[i].apply(this,t[i]):this[i].call(this,t[i]):F.debug(`Not a valid option setter name: ${i}`);return this}on(t,e){return this._listeners.on(t,e),this}withoutTransitions(t){const e=this.conf().transitionDuration;this.configure({transitionDuration:0}),t(),this.configure({transitionDuration:e})}renderlet(t){return F.warnOnce('chart.renderlet has been deprecated. Please use chart.on("renderlet.<renderletKey>", renderletFunction)'),this.on(`renderlet.${j()}`,t),this}}function At(t){return class extends t{constructor(...t){super(...t),this.configure({renderLabel:!0,maxBubbleRelativeSize:.3,minRadiusWithLabel:10,sortBubbleSize:!1,elasticRadius:!1,excludeElasticZero:!0,radiusValueAccessor:t=>t.r}),this.BUBBLE_NODE_CLASS="node",this.BUBBLE_CLASS="bubble",this.MIN_RADIUS=10,this._r=a.scaleLinear().domain([0,100])}configure(t){return super.configure(t),this}conf(){return this._conf}data(){const t=super.data();if(this._conf.sortBubbleSize){const e=this._conf.radiusValueAccessor;t.sort(((t,i)=>n.descending(e(t),e(i))))}return t}r(t){return arguments.length?(this._r=t,this):this._r}calculateRadiusDomain(){this._conf.elasticRadius&&this.r().domain([this.rMin(),this.rMax()])}rMin(){let t=this.data().map(this._conf.radiusValueAccessor);return this._conf.excludeElasticZero&&(t=t.filter((t=>t>0))),n.min(t)}rMax(){return n.max(this.data(),(t=>this._conf.radiusValueAccessor(t)))}bubbleR(t){const e=this._conf.radiusValueAccessor(t);let i=this.r()(e);return(isNaN(i)||e<=0)&&(i=0),i}_labelFunction(t){return this._conf.label(t)}_shouldLabel(t){return this.bubbleR(t)>this._conf.minRadiusWithLabel}_labelOpacity(t){return this._shouldLabel(t)?1:0}_labelPointerEvent(t){return this._shouldLabel(t)?"all":"none"}_doRenderLabel(t){if(this._conf.renderLabel){let e=t.select("text");e.empty()&&(e=t.append("text").attr("text-anchor","middle").attr("dy",".3em").on("click",((t,e)=>this.onClick(e)))),e.attr("opacity",0).attr("pointer-events",(t=>this._labelPointerEvent(t))).text((t=>this._labelFunction(t))),B(e,this._conf.transitionDuration,this._conf.transitionDelay).attr("opacity",(t=>this._labelOpacity(t)))}}doUpdateLabels(t){if(this._conf.renderLabel){B(t.select("text").attr("pointer-events",(t=>this._labelPointerEvent(t))).text((t=>this._labelFunction(t))),this._conf.transitionDuration,this._conf.transitionDelay).attr("opacity",(t=>this._labelOpacity(t)))}}_titleFunction(t){return this._conf.title(t)}_doRenderTitles(t){if(this._conf.renderTitle){t.select("title").empty()&&t.append("title").text((t=>this._titleFunction(t)))}}doUpdateTitles(t){this._conf.renderTitle&&t.select("title").text((t=>this._titleFunction(t)))}minRadius(t){return arguments.length?(this.MIN_RADIUS=t,this):this.MIN_RADIUS}fadeDeselectedArea(t){if(this.hasFilter()){const t=this;this.selectAll(`g.${t.BUBBLE_NODE_CLASS}`).each((function(e){t.isSelectedNode(e)?t.highlightSelected(this):t.fadeDeselected(this)}))}else{const t=this;this.selectAll(`g.${t.BUBBLE_NODE_CLASS}`).each((function(){t.resetHighlight(this)}))}}isSelectedNode(t){return this.hasFilter(t.key)}onClick(t){const e=t.key;T.trigger((()=>{this.filter(e),this.redrawGroup()}))}}}function bt(t){return class extends t{constructor(...t){super(...t),this.configure({colorAccessor:(t,e)=>this._conf.keyAccessor(t)}),this.colorHelper(new dt(O.defaultColors()))}configure(t){return super.configure(t),"colorAccessor"in t&&this._colorHelper&&(this._colorHelper.colorAccessor=t.colorAccessor),this}conf(){return this._conf}colorHelper(t){return arguments.length?(this._colorHelper=t,this._colorHelper.colorAccessor=this._conf.colorAccessor,this):this._colorHelper}ordinalColors(t){return this.colorHelper(new dt(t)),this}colorScale(t){return this.colorHelper(new lt(t))}linearColors(t){return this.colorHelper(new ct(t)),this}colorCalculator(t){return arguments.length?(this.colorHelper(new ht(t)),this):this.colorHelper().getColor}colorDomain(t){const e=this.colorHelper().colorScale;return arguments.length?(e.domain(t),this):e.domain()}calculateColorDomain(){const t=this._colorHelper.colorScale;return t&&t.domain&&t.domain(n.extent(this.data(),this._conf.colorAccessor)),this}}}class vt extends xt{constructor(t,e){super(t,e),this._margins={top:10,right:50,bottom:30,left:30}}configure(t){return super.configure(t),this}conf(){return this._conf}margins(t){return arguments.length?(this._margins=t,this):this._margins}effectiveWidth(){return this.width()-this.margins().left-this.margins().right}effectiveHeight(){return this.height()-this.margins().top-this.margins().bottom}}const Ct="x-axis-label",wt="custom-brush-handle";class St extends(bt(vt)){constructor(t,e){super(t,e),this.colorHelper(new dt(c.schemeCategory10)),this._mandatoryAttributes().push("x"),this._parent=void 0,this._g=void 0,this._chartBodyG=void 0,this.configure({xUnits:nt,xAxisPadding:0,xAxisPaddingUnit:r.timeDay,elasticX:!1,yAxisPadding:0,elasticY:!1,round:void 0,renderHorizontalGridLines:!1,renderVerticalGridLines:!1,zoomScale:[1,1/0],zoomOutRestrict:!0,mouseZoomable:!1,autoFocus:!1,clipPadding:0,useRightYAxis:!1,brushOn:!0,parentBrushOn:!1}),this._x=void 0,this._origX=void 0,this._xOriginalDomain=void 0,this._xAxis=d.axisBottom(void 0),this._xAxisLabel=void 0,this._xAxisLabelPadding=0,this._lastXDomain=void 0,this._y=void 0,this._yAxis=null,this._yAxisLabel=void 0,this._yAxisLabelPadding=0,this._brush=u.brushX(),this._gBrush=void 0,this._ignoreBrushEvents=!1,this._resizing=!1,this._unitCount=void 0,this._zoom=_.zoom().on("zoom",((t,e)=>this._onZoom(t))),this._nullZoom=_.zoom().on("zoom",null),this._hasBeenMouseZoomable=!1,this._ignoreZoomEvents=!1,this.on("filtered._coordinate",(()=>{this._onFilterChange()})),this._fOuterRangeBandPadding=.5,this._fRangeBandPadding=0}configure(t){return super.configure(t),this}conf(){return this._conf}rescale(){return this._unitCount=void 0,this._resizing=!0,this}resizing(t){return arguments.length?(this._resizing=t,this):this._resizing}handleResize(t){this.rescale(),super.handleResize(t)}_generateG(t){this._parent=void 0===t?this.svg():t;const e=window.location.href.split("#")[0];return this._g=this._parent.append("g"),this._chartBodyG=this._g.append("g").attr("class","chart-body").attr("transform",`translate(${this.margins().left}, ${this.margins().top})`).attr("clip-path",`url(${e}#${this._getClipPathId()})`),this._g}g(t){return arguments.length?(this._g=t,this):this._g}chartBodyG(t){return arguments.length?(this._chartBodyG=t,this):this._chartBodyG}x(t){return arguments.length?(this._x=t,this._xOriginalDomain=this._x.domain(),this.rescale(),this):this._x}xOriginalDomain(){return this._xOriginalDomain}xAxis(t){return arguments.length?(this._xAxis=t,this):this._xAxis}xUnitCount(){if(void 0===this._unitCount)if(this.isOrdinal())this._unitCount=this.x().domain().length;else{const[t,e]=this.x().domain(),i=this._conf.xUnits(t,e);this._unitCount=i instanceof Array?i.length:i}return this._unitCount}isOrdinal(){return this._conf.xUnits===at}_useOuterPadding(){return!0}_ordinalXDomain(){return this._computeOrderedGroups(this.data()).map(this._conf.keyAccessor)}_prepareXAxis(t,e){this.isOrdinal()?(this._x.bandwidth||(F.warn("For compatibility with d3v4+, dc.js d3.0 ordinal bar/line/bubble charts need d3.scaleBand() for the x scale, instead of d3.scaleOrdinal(). Replacing .x() with a d3.scaleBand with the same domain - make the same change in your code to avoid this warning!"),this._x=a.scaleBand().domain(this._x.domain())),(this._conf.elasticX||0===this._x.domain().length)&&this._x.domain(this._ordinalXDomain())):this._conf.elasticX&&this._x.domain([this.xAxisMin(),this.xAxisMax()]);const i=this._x.domain();!e&&Q(this._lastXDomain,i)||this.rescale(),this._lastXDomain=i,this.isOrdinal()?this._x.range([0,this._xAxisLength()]).paddingInner(this._fRangeBandPadding).paddingOuter(this._useOuterPadding()?this._fOuterRangeBandPadding:0):this._x.range([0,this._xAxisLength()]),this._xAxis=this._xAxis.scale(this.x()),this._renderVerticalGridLines(t)}_renderXAxis(t){let e=t.select("g.x");e.empty()&&(e=t.append("g").attr("class","axis x").attr("transform",`translate(${this.margins().left},${this._xAxisY()})`));let i=t.select("text.x-axis-label");i.empty()&&this.xAxisLabel()&&(i=t.append("text").attr("class",Ct).attr("transform",`translate(${this.margins().left+this._xAxisLength()/2},${this.height()-this._xAxisLabelPadding})`).attr("text-anchor","middle")),this.xAxisLabel()&&i.text()!==this.xAxisLabel()&&i.text(this.xAxisLabel()),B(e,this._conf.transitionDuration,this._conf.transitionDelay).attr("transform",`translate(${this.margins().left},${this._xAxisY()})`).call(this._xAxis),B(i,this._conf.transitionDuration,this._conf.transitionDelay).attr("transform",`translate(${this.margins().left+this._xAxisLength()/2},${this.height()-this._xAxisLabelPadding})`)}_renderVerticalGridLines(t){let e=t.select("g.vertical");if(this._conf.renderVerticalGridLines){let i;e.empty()&&(e=t.insert("g",":first-child").attr("class","grid-line vertical").attr("transform",`translate(${this.margins().left},${this.margins().top})`)),i=this._xAxis.tickValues()?this._xAxis.tickValues():"function"==typeof this._x.ticks?this._x.ticks.apply(this._x,this._xAxis.tickArguments()):this._x.domain();const s=e.selectAll("line").data(i);B(s.enter().append("line").attr("x1",(t=>this._x(t))).attr("y1",this._xAxisY()-this.margins().top).attr("x2",(t=>this._x(t))).attr("y2",0).attr("opacity",0),this._conf.transitionDuration,this._conf.transitionDelay).attr("opacity",.5),B(s,this._conf.transitionDuration,this._conf.transitionDelay).attr("x1",(t=>this._x(t))).attr("y1",this._xAxisY()-this.margins().top).attr("x2",(t=>this._x(t))).attr("y2",0),s.exit().remove()}else e.selectAll("line").remove()}_xAxisY(){return this.height()-this.margins().bottom}_xAxisLength(){return this.effectiveWidth()}xAxisLabel(t,e){return arguments.length?(this._xAxisLabel=t,this.margins().bottom-=this._xAxisLabelPadding,this._xAxisLabelPadding=void 0===e?12:e,this.margins().bottom+=this._xAxisLabelPadding,this):this._xAxisLabel}_createYAxis(){return this._conf.useRightYAxis?d.axisRight(void 0):d.axisLeft(void 0)}_prepareYAxis(t){if(void 0===this._y||this._conf.elasticY){void 0===this._y&&(this._y=a.scaleLinear());const t=this.yAxisMin()||0,e=this.yAxisMax()||0;this._y.domain([t,e]).rangeRound([this._yAxisHeight(),0])}this._y.range([this._yAxisHeight(),0]),this._yAxis||(this._yAxis=this._createYAxis()),this._yAxis.scale(this._y),this._renderHorizontalGridLinesForAxis(t,this._y,this._yAxis)}_renderYAxisLabel(t,e,i,s){s=s||this._yAxisLabelPadding;let r=this.g().select(`text.y-axis-label.${t}-label`);const n=this.margins().top+this._yAxisHeight()/2;r.empty()&&e&&(r=this.g().append("text").attr("transform",`translate(${s},${n}),rotate(${i})`).attr("class",`y-axis-label ${t}-label`).attr("text-anchor","middle").text(e)),e&&r.text()!==e&&r.text(e),B(r,this._conf.transitionDuration,this._conf.transitionDelay).attr("transform",`translate(${s},${n}),rotate(${i})`)}_renderYAxisAt(t,e,i){let s=this.g().select(`g.${t}`);s.empty()&&(s=this.g().append("g").attr("class",`axis ${t}`).attr("transform",`translate(${i},${this.margins().top})`)),B(s,this._conf.transitionDuration,this._conf.transitionDelay).attr("transform",`translate(${i},${this.margins().top})`).call(e)}_renderYAxis(){const t=this._conf.useRightYAxis?this.width()-this.margins().right:this._yAxisX();this._renderYAxisAt("y",this._yAxis,t);const e=this._conf.useRightYAxis?this.width()-this._yAxisLabelPadding:this._yAxisLabelPadding,i=this._conf.useRightYAxis?90:-90;this._renderYAxisLabel("y",this.yAxisLabel(),i,e)}_renderHorizontalGridLinesForAxis(t,e,i){let s=t.select("g.horizontal");if(this._conf.renderHorizontalGridLines){let r;r=i.tickValues()?i.tickValues():e.ticks?e.ticks.apply(e,i.tickArguments()):e.domain(),s.empty()&&(s=t.insert("g",":first-child").attr("class","grid-line horizontal").attr("transform",`translate(${this.margins().left},${this.margins().top})`));const n=s.selectAll("line").data(r);B(n.enter().append("line").attr("x1",1).attr("y1",(t=>e(t))).attr("x2",this._xAxisLength()).attr("y2",(t=>e(t))).attr("opacity",0),this._conf.transitionDuration,this._conf.transitionDelay).attr("opacity",.5),B(n,this._conf.transitionDuration,this._conf.transitionDelay).attr("x1",1).attr("y1",(t=>e(t))).attr("x2",this._xAxisLength()).attr("y2",(t=>e(t))),n.exit().remove()}else s.selectAll("line").remove()}_yAxisX(){return this._conf.useRightYAxis?this.width()-this.margins().right:this.margins().left}yAxisLabel(t,e){return arguments.length?(this._yAxisLabel=t,this.margins().left-=this._yAxisLabelPadding,this._yAxisLabelPadding=void 0===e?12:e,this.margins().left+=this._yAxisLabelPadding,this):this._yAxisLabel}y(t){return arguments.length?(this._y=t,this.rescale(),this):this._y}yAxis(t){return arguments.length?(this._yAxis=t,this):(this._yAxis||(this._yAxis=this._createYAxis()),this._yAxis)}xAxisMin(){return I(n.min(this.data(),(t=>this._conf.keyAccessor(t))),this._conf.xAxisPadding,this._conf.xAxisPaddingUnit)}xAxisMax(){return Y(n.max(this.data(),(t=>this._conf.keyAccessor(t))),this._conf.xAxisPadding,this._conf.xAxisPaddingUnit)}yAxisMin(){return I(n.min(this.data(),(t=>t._value)),this._conf.yAxisPadding)}yAxisMax(){return Y(n.max(this.data(),(t=>t._value)),this._conf.yAxisPadding)}_yAxisHeight(){return this.effectiveHeight()}_rangeBandPadding(t){return arguments.length?(this._fRangeBandPadding=t,this):this._fRangeBandPadding}_outerRangeBandPadding(t){return arguments.length?(this._fOuterRangeBandPadding=t,this):this._fOuterRangeBandPadding}_onFilterChange(){const t=this.filter();this._redrawBrush(t,!1),this._conf.autoFocus&&this._updateUIforZoom(t,!0)}brush(t){return arguments.length?(this._brush=t,this):this._brush}_renderBrush(t,e){this._conf.brushOn&&(this._brush.on("start brush end",((t,e)=>this._brushing(t))),this._gBrush=t.append("g").attr("class","brush").attr("transform",`translate(${this.margins().left},${this.margins().top})`),this._setBrushExtents(e),this._createBrushHandlePaths(this._gBrush,e),this._redrawBrush(this.filter(),e))}_createBrushHandlePaths(t,e){let i=t.selectAll("path.custom-brush-handle").data([{type:"w"},{type:"e"}]);i=i.enter().append("path").attr("class",wt).merge(i),i.attr("d",(t=>this._resizeHandlePath(t)))}_extendBrush(t){return t&&this._conf.round&&(t[0]=this._conf.round(t[0]),t[1]=this._conf.round(t[1])),t}_brushIsEmpty(t){return!t||t[1]<=t[0]}_brushing(t){if(this._ignoreBrushEvents)return;const e=t.selection;let i;e&&(i=e.map(this.x().invert)),i=this._extendBrush(i),this._redrawBrush(i,!1);const s=this._brushIsEmpty(i)?null:new x(i[0],i[1]);T.trigger((()=>{this._applyBrushSelection(s)}),R.EVENT_DELAY)}_applyBrushSelection(t){this.replaceFilter(t),this.redrawGroup()}_withoutBrushEvents(t){const e=this._ignoreBrushEvents;this._ignoreBrushEvents=!0;try{t()}finally{this._ignoreBrushEvents=e}}_setBrushExtents(t){this._withoutBrushEvents((()=>{this._brush.extent([[0,0],[this.effectiveWidth(),this.effectiveHeight()]])})),this._gBrush.call(this._brush)}_redrawBrush(t,e){if(this._conf.brushOn&&this._gBrush)if(this._resizing&&this._setBrushExtents(e),t){const i=[this._x(t[0]),this._x(t[1])],s=$(e,this._conf.transitionDuration,this._conf.transitionDelay)(this._gBrush);this._withoutBrushEvents((()=>{s.call(this._brush.move,i)})),s.selectAll("path.custom-brush-handle").attr("display",null).attr("transform",((e,i)=>`translate(${this._x(t[i])}, 0)`)).attr("d",(t=>this._resizeHandlePath(t)))}else this._withoutBrushEvents((()=>{this._gBrush.call(this._brush.move,null)})),this._gBrush.selectAll("path.custom-brush-handle").attr("display","none");this.fadeDeselectedArea(t)}fadeDeselectedArea(t){}_resizeHandlePath(t){const e=+("e"===(t=t.type)),i=e?1:-1,s=this.effectiveHeight()/3;return`M${.5*i},${s}A6,6 0 0 ${e} ${6.5*i},${s+6}V${2*s-6}A6,6 0 0 ${e} ${.5*i},${2*s}ZM${2.5*i},${s+8}V${2*s-8}M${4.5*i},${s+8}V${2*s-8}`}_getClipPathId(){return`${this.anchorName().replace(/[ .#=\[\]"]/g,"-")}-clip`}_generateClipPath(){const t=K(this._parent,"defs"),e=this._getClipPathId(),i=K(t,`#${e}`,"clipPath").attr("id",e),s=2*this._conf.clipPadding;K(i,"rect").attr("width",this._xAxisLength()+s).attr("height",this._yAxisHeight()+s).attr("transform",`translate(-${this._conf.clipPadding}, -${this._conf.clipPadding})`)}_preprocessData(){}_doRender(){return this.resetSvg(),this._preprocessData(),this._generateG(),this._generateClipPath(),this._drawChart(!0),this._configureMouseZoom(),this}_doRedraw(){return this._preprocessData(),this._drawChart(!1),this._generateClipPath(),this}_drawChart(t){this.isOrdinal()&&this.configure({brushOn:!1}),this._prepareXAxis(this.g(),t),this._prepareYAxis(this.g()),this.plotData(),(this._conf.elasticX||this._resizing||t)&&this._renderXAxis(this.g()),(this._conf.elasticY||this._resizing||t)&&this._renderYAxis(),t?this._renderBrush(this.g(),!1):this._redrawBrush(this.filter(),this._resizing),this.fadeDeselectedArea(this.filter()),this.resizing(!1)}plotData(){throw new Error("Method not implemented.")}_configureMouseZoom(){this._origX=this._x.copy(),this._conf.mouseZoomable?this._enableMouseZoom():this._hasBeenMouseZoomable&&this._disableMouseZoom()}_enableMouseZoom(){this._hasBeenMouseZoomable=!0;const t=[[0,0],[this.effectiveWidth(),this.effectiveHeight()]];if(this._zoom.scaleExtent(this._conf.zoomScale).extent(t).duration(this._conf.transitionDuration),this._conf.zoomOutRestrict){const e=Math.max(this._conf.zoomScale[0],1);this._zoom.translateExtent(t).scaleExtent([e,this._conf.zoomScale[1]])}this.root().call(this._zoom),this._updateD3zoomTransform()}_disableMouseZoom(){this.root().call(this._nullZoom)}_updateUIforZoom(t,e){t instanceof Array&&t.length>1?this.x().domain(t):this.x().domain(this._xOriginalDomain),this.rescale(),this.redraw(),this._updateD3zoomTransform(),e||(this._invokeZoomedListener(),T.trigger((()=>{this.redrawGroup()}),R.EVENT_DELAY))}_domainToZoomTransform(t,e,i){const s=(e[1]-e[0])/(t[1]-t[0]),r=-1*i(t[0]);return _.zoomIdentity.scale(s).translate(r,0)}_updateD3zoomTransform(){this._zoom&&this._withoutZoomEvents((()=>{this._zoom.transform(this.root(),this._domainToZoomTransform(this.x().domain(),this._xOriginalDomain,this._origX))}))}_withoutZoomEvents(t){const e=this._ignoreZoomEvents;this._ignoreZoomEvents=!0;try{t()}finally{this._ignoreZoomEvents=e}}_onZoom(t){if(this._ignoreZoomEvents)return;const e=t.transform.rescaleX(this._origX).domain();this.focus(e)}_checkExtents(t,e){return t&&2===t.length&&e&&2===e.length?((t[0]>e[1]||t[1]<e[0])&&F.warn("Could not intersect extents, will reset"),[t[0]>e[0]?t[0]:e[0],t[1]<e[1]?t[1]:e[1]]):t}focus(t){let e;this._conf.zoomOutRestrict&&(t=this._checkExtents(t,this._xOriginalDomain)),e=t instanceof Array&&t.length>1?new x(t[0],t[1]):null,this.replaceFilter(e),this._updateUIforZoom(t,!1)}refocused(){return!Q(this.x().domain(),this._xOriginalDomain)}}class Lt extends mt{constructor(t={}){super(Object.assign({layers:[],valueAccessor:t=>t.value},t))}configure(t){return super.configure(t)}conf(){return super.conf()}data(){return this.layers().map((t=>{const e=t.valueAccessor||this._conf.valueAccessor,i=t.group.all().map((t=>Object.assign(Object.assign({},t),{_value:e(t)})));return{name:t.name,rawData:i}}))}layers(){if(this._conf.group){return[{name:this._conf.groupName,group:this._conf.group}].concat(this._conf.layers)}return this._conf.layers}layerByName(t){return this._conf.layers.find((e=>e.name===t))}}class Rt extends St{constructor(t,e){super(t,e),this.configure({colorAccessor:t=>t.name,hidableStacks:!1,evadeDomainFilter:!1}),this.dataProvider(new Lt),this._stackLayout=f.stack(),this._hiddenStacks={}}configure(t){return super.configure(t),this}conf(){return this._conf}dataProvider(t){return arguments.length?super.dataProvider(t):super.dataProvider()}data(){let t=this.dataProvider().data();if(t=t.filter((t=>this._isLayerVisible(t.name))),!t.length)return[];t.forEach((t=>{const e=t.rawData.map(((e,i)=>({x:this._conf.keyAccessor(e,i),y:e._value,data:e,name:t.name})));t.domainValues=e.filter((t=>this._domainFilter()(t))),t.values=this._conf.evadeDomainFilter?e:t.domainValues}));const e=t[0].values.map(((e,i)=>{const s={x:e.x};return t.forEach((t=>{s[t.name]=t.values[i].y})),s})),i=t.map((t=>t.name));return this.stackLayout().keys(i)(e).forEach(((e,i)=>{e.forEach(((e,s)=>{t[i].values[s].y0=e[0],t[i].values[s].y1=e[1]}))})),t}_domainFilter(){if(!this.x())return()=>!0;const t=this.x().domain();return this.isOrdinal()||this._conf.elasticX?()=>!0:e=>e.x>=t[0]&&e.x<=t[t.length-1]}hideStack(t){return this._hiddenStacks[t]=!0,this}showStack(t){return this._hiddenStacks[t]=!1,this}_isLayerVisible(t){return!this._hiddenStacks[t]}yAxisMin(){return I(n.min(this._flattenStack(),(t=>t.y<0?t.y+t.y0:t.y0)),this._conf.yAxisPadding)}yAxisMax(){return Y(n.max(this._flattenStack(),(t=>t.y>0?t.y+t.y0:t.y0)),this._conf.yAxisPadding)}_flattenStack(){return this.data().flatMap((t=>t.domainValues))}xAxisMin(){return I(n.min(this._flattenStack(),(t=>t.x)),this._conf.xAxisPadding,this._conf.xAxisPaddingUnit)}xAxisMax(){return Y(n.max(this._flattenStack(),(t=>t.x)),this._conf.xAxisPadding,this._conf.xAxisPaddingUnit)}titleFn(t){return this._conf.titles&&this._conf.titles[t]||this._conf.title}stackLayout(t){return arguments.length?(this._stackLayout=t,this):this._stackLayout}_ordinalXDomain(){const t=this._flattenStack().map((t=>t.data));return this._computeOrderedGroups(t).map(this._conf.keyAccessor)}legendables(){return this.dataProvider().layers().map(((t,e)=>({chart:this,name:t.name,hidden:!this._isLayerVisible(t.name),color:this._colorHelper.getColor(t,e)})))}isLegendableHidden(t){return!this._isLayerVisible(t.name)}legendToggle(t){this._conf.hidableStacks&&(this.isLegendableHidden(t)?this.showStack(t.name):this.hideStack(t.name),this.renderGroup())}}class Dt extends(At(St)){constructor(t,e){super(t,e),this.configure({transitionDuration:750,transitionDelay:0,brushOn:!1}),this._bubbleLocator=t=>`translate(${this._bubbleX(t)},${this._bubbleY(t)})`}plotData(){this.calculateRadiusDomain(),this.r().range([this.MIN_RADIUS,this._xAxisLength()*this._conf.maxBubbleRelativeSize]);const t=this.data();let e=this.chartBodyG().selectAll(`g.${this.BUBBLE_NODE_CLASS}`).data(t,(t=>t.key));this._conf.sortBubbleSize&&e.order(),this._removeNodes(e),e=this._renderNodes(e),this._updateNodes(e),this.fadeDeselectedArea(this.filter())}_renderNodes(t){const e=t.enter().append("g");return e.attr("class",this.BUBBLE_NODE_CLASS).attr("transform",(t=>this._bubbleLocator(t))).append("circle").attr("class",((t,e)=>`${this.BUBBLE_CLASS} _${e}`)).on("click",((t,e)=>this.onClick(e))).attr("fill",((t,e)=>this._colorHelper.getColor(t,e))).attr("r",0),B(t=e.merge(t),this._conf.transitionDuration,this._conf.transitionDelay).select(`circle.${this.BUBBLE_CLASS}`).attr("r",(t=>this.bubbleR(t))).attr("opacity",(t=>this.bubbleR(t)>0?1:0)),this._doRenderLabel(e),this._doRenderTitles(e),t}_updateNodes(t){B(t,this._conf.transitionDuration,this._conf.transitionDelay).attr("transform",(t=>this._bubbleLocator(t))).select(`circle.${this.BUBBLE_CLASS}`).attr("fill",((t,e)=>this._colorHelper.getColor(t,e))).attr("r",(t=>this.bubbleR(t))).attr("opacity",(t=>this.bubbleR(t)>0?1:0)),this.doUpdateLabels(t),this.doUpdateTitles(t)}_removeNodes(t){t.exit().remove()}_bubbleX(t){let e=this.x()(this._conf.keyAccessor(t));return!isNaN(e)&&isFinite(e)||(e=0),e}_bubbleY(t){let e=this.y()(t._value);return!isNaN(e)&&isFinite(e)||(e=0),e}}const kt="bubble-overlay",Ft="bubble";class Pt extends(At(bt(xt))){constructor(t,e){super(t,e),this.configure({points:[]}),this._g=void 0,this.configure({transitionDuration:750,transitionDelay:0,radiusValueAccessor:t=>t.value})}configure(t){return super.configure(t),this}conf(){return this._conf}svg(t){return arguments.length?(super.svg(t),this):super.svg()}_doRender(){return this._g=this._initOverlayG(),this.r().range([this.MIN_RADIUS,this.width()*this._conf.maxBubbleRelativeSize]),this._initializeBubbles(),this.fadeDeselectedArea(this.filter()),this}_initOverlayG(){return this._g=this.select("g.bubble-overlay"),this._g.empty()&&(this._g=this.svg().append("g").attr("class",kt)),this._g}_initializeBubbles(){const t=this._mapData();this.calculateRadiusDomain(),this._conf.points.forEach((e=>{const i=this._getNodeG(e,t);let s=i.select("circle.bubble");s.empty()&&(s=i.append("circle").attr("class",Ft).attr("r",0).attr("fill",((t,e)=>this._colorHelper.getColor(t,e))).on("click",((t,e)=>this.onClick(e)))),B(s,this._conf.transitionDuration,this._conf.transitionDelay).attr("r",(t=>this.bubbleR(t))),this._doRenderLabel(i),this._doRenderTitles(i)}))}_mapData(){const t={};return this.data().forEach((e=>{t[this._conf.keyAccessor(e)]=e})),t}_getNodeG(t,e){const i=`node ${Z(t.name)}`;let s=this._g.select(`g.${Z(t.name)}`);return s.empty()&&(s=this._g.append("g").attr("class",i).attr("transform",`translate(${t.x},${t.y})`)),s.datum(e[t.name]),s}_doRedraw(){return this._updateBubbles(),this.fadeDeselectedArea(this.filter()),this}_updateBubbles(){const t=this._mapData();this.calculateRadiusDomain(),this._conf.points.forEach((e=>{const i=this._getNodeG(e,t);B(i.select("circle.bubble"),this._conf.transitionDuration,this._conf.transitionDelay).attr("r",(t=>this.bubbleR(t))).attr("fill",((t,e)=>this._colorHelper.getColor(t,e))),this.doUpdateLabels(i),this.doUpdateTitles(i)}))}debug(t=!1){if(t){let t=this.select(`g.${R.DEBUG_GROUP_CLASS}`);t.empty()&&(t=this.svg().append("g").attr("class",R.DEBUG_GROUP_CLASS));const e=t.append("text").attr("x",10).attr("y",20);t.append("rect").attr("width",this.width()).attr("height",this.height()).on("mousemove",((i,s)=>{const r=h.pointer(i,t.node()),n=`${r[0]}, ${r[1]}`;e.text(n)}))}else this.selectAll(".debug").remove();return this}}const Ot="dc-cbox-item";class Bt extends St{constructor(t,e){super(t,e),this.configure({transitionDuration:500,transitionDelay:0,shareColors:!1,shareTitle:!0}),this._children=[],this._childOptions={},this._alignYAxes=!1,this._rightYAxis=d.axisRight(void 0),this._rightYAxisLabel=void 0,this._rightYAxisLabelPadding=12,this._rightY=void 0,this._rightAxisGridLines=!1,this._mandatoryAttributes([]),this.on("filtered.dcjs-composite-chart",(t=>{this._children.forEach((t=>{t.filter()!==this.filter()&&t.replaceFilter(this.filter())}))}))}configure(t){return super.configure(t),this}conf(){return this._conf}_generateG(){const t=super._generateG();for(let t=0;t<this._children.length;++t){const e=this._children[t];this._generateChildG(e,t),e.dataProvider().conf().dimension||e.dataProvider().configure({dimension:this.dataProvider().conf().dimension}),e.dataProvider().conf().group||e.dataProvider().configure({group:this.dataProvider().conf().group}),e.dataProvider().configure({shareFilters:this.dataProvider().conf().shareFilters}),e.configure({xUnits:this._conf.xUnits,transitionDuration:this._conf.transitionDuration,transitionDelay:this._conf.transitionDelay,renderTitle:this._conf.renderTitle,elasticX:this._conf.elasticX}),e.chartGroup(this.chartGroup()),e.svg(this.svg()),e.configure({parentBrushOn:this._conf.brushOn,brushOn:!1})}return t}rescale(){return super.rescale(),this._children.forEach((t=>{t.rescale()})),this}resizing(t){return arguments.length?(super.resizing(t),this._children.forEach((e=>{e.resizing(t)})),this):super.resizing()}_prepareYAxis(){const t=0!==this._leftYAxisChildren().length,e=0!==this._rightYAxisChildren().length,i=this._calculateYAxisRanges(t,e);t&&this._prepareLeftYAxis(i),e&&this._prepareRightYAxis(i),this._leftYAxisChildren().length>0&&!this._rightAxisGridLines?this._renderHorizontalGridLinesForAxis(this.g(),this.y(),this.yAxis()):this._rightYAxisChildren().length>0&&this._renderHorizontalGridLinesForAxis(this.g(),this._rightY,this._rightYAxis)}_renderYAxis(){0!==this._leftYAxisChildren().length&&(this._renderYAxisAt("y",this.yAxis(),this.margins().left),this._renderYAxisLabel("y",this.yAxisLabel(),-90)),0!==this._rightYAxisChildren().length&&(this._renderYAxisAt("yr",this.rightYAxis(),this.width()-this.margins().right),this._renderYAxisLabel("yr",this.rightYAxisLabel(),90,this.width()-this._rightYAxisLabelPadding))}_calculateYAxisRanges(t,e){let i,s,r,n,a;return t&&(i=this._yAxisMin(),s=this._yAxisMax()),e&&(r=this._rightYAxisMin(),n=this._rightYAxisMax()),this.alignYAxes()&&t&&e&&(a=this._alignYAxisRanges(i,s,r,n)),a||{lyAxisMin:i,lyAxisMax:s,ryAxisMin:r,ryAxisMax:n}}_alignYAxisRanges(t,e,i,s){const r=(s-i)/(e-t);return{lyAxisMin:Math.min(t,i/r),lyAxisMax:Math.max(e,s/r),ryAxisMin:Math.min(i,t*r),ryAxisMax:Math.max(s,e*r)}}_prepareRightYAxis(t){const e=void 0===this.rightY()||this._conf.elasticY,i=e||this.resizing();void 0===this.rightY()&&this.rightY(a.scaleLinear()),e&&this.rightY().domain([t.ryAxisMin,t.ryAxisMax]),i&&this.rightY().rangeRound([this._yAxisHeight(),0]),this.rightY().range([this._yAxisHeight(),0]),this.rightYAxis(this.rightYAxis().scale(this.rightY()))}_prepareLeftYAxis(t){const e=void 0===this.y()||this._conf.elasticY,i=e||this.resizing();void 0===this.y()&&this.y(a.scaleLinear()),e&&this.y().domain([t.lyAxisMin,t.lyAxisMax]),i&&this.y().rangeRound([this._yAxisHeight(),0]),this.y().range([this._yAxisHeight(),0]),this.yAxis(this.yAxis().scale(this.y()))}_generateChildG(t,e){t._generateG(this.g()),t.g().attr("class",`sub _${e}`)}plotData(){for(let t=0;t<this._children.length;++t){const e=this._children[t];e.g()||this._generateChildG(e,t),this._conf.shareColors&&e.colorHelper(this.colorHelper().share(e.conf().colorAccessor)),e.x(this.x()),e.xAxis(this.xAxis()),e.conf().useRightYAxis?(e.y(this.rightY()),e.yAxis(this.rightYAxis())):(e.y(this.y()),e.yAxis(this.yAxis())),e.plotData(),e._activateRenderlets()}}useRightAxisGridLines(t){return arguments?(this._rightAxisGridLines=t,this):this._rightAxisGridLines}childOptions(t){return arguments.length?(this._childOptions=t,this._children.forEach((t=>{t.options(this._childOptions)})),this):this._childOptions}fadeDeselectedArea(t){if(this._conf.brushOn)for(let e=0;e<this._children.length;++e){this._children[e].fadeDeselectedArea(t)}}rightYAxisLabel(t,e){return arguments.length?(this._rightYAxisLabel=t,this.margins().right-=this._rightYAxisLabelPadding,this._rightYAxisLabelPadding=void 0===e?12:e,this.margins().right+=this._rightYAxisLabelPadding,this):this._rightYAxisLabel}compose(t){return this._children=t,this._children.forEach((t=>{t.height=()=>this.height(),t.width=()=>this.width(),t.margins=()=>this.margins(),this._conf.shareTitle&&t.configure({title:this._conf.title}),t.options(this._childOptions)})),this.rescale(),this}withoutTransitions(t){const e=this._children.map((t=>t.conf().transitionDuration));this._children.forEach((t=>t.configure({transitionDuration:0}))),super.withoutTransitions(t),this._children.forEach(((t,i)=>t.configure({transitionDuration:e[i]})))}children(){return this._children}rightY(t){return arguments.length?(this._rightY=t,this.rescale(),this):this._rightY}alignYAxes(t){return arguments.length?(this._alignYAxes=t,this.rescale(),this):this._alignYAxes}_leftYAxisChildren(){return this._children.filter((t=>!t.conf().useRightYAxis))}_rightYAxisChildren(){return this._children.filter((t=>t.conf().useRightYAxis))}_getYAxisMin(t){return t.map((t=>t.yAxisMin()))}_yAxisMin(){return n.min(this._getYAxisMin(this._leftYAxisChildren()))}_rightYAxisMin(){return n.min(this._getYAxisMin(this._rightYAxisChildren()))}_getYAxisMax(t){return t.map((t=>t.yAxisMax()))}_yAxisMax(){return Y(n.max(this._getYAxisMax(this._leftYAxisChildren())),this._conf.yAxisPadding)}_rightYAxisMax(){return Y(n.max(this._getYAxisMax(this._rightYAxisChildren())),this._conf.yAxisPadding)}_getAllXAxisMinFromChildCharts(){return this._children.map((t=>t.xAxisMin()))}xAxisMin(){return I(n.min(this._getAllXAxisMinFromChildCharts()),this._conf.xAxisPadding,this._conf.xAxisPaddingUnit)}_getAllXAxisMaxFromChildCharts(){return this._children.map((t=>t.xAxisMax()))}xAxisMax(){return Y(n.max(this._getAllXAxisMaxFromChildCharts()),this._conf.xAxisPadding,this._conf.xAxisPaddingUnit)}legendables(){return this._children.reduce(((t,e)=>(this._conf.shareColors&&e.colorHelper(this.colorHelper().share(e.conf().colorAccessor)),t.push.apply(t,e.legendables()),t)),[])}legendHighlight(t){for(let e=0;e<this._children.length;++e){this._children[e].legendHighlight(t)}}legendReset(t){for(let e=0;e<this._children.length;++e){this._children[e].legendReset(t)}}legendToggle(){console.log("composite should not be getting legendToggle itself")}rightYAxis(t){return arguments.length?(this._rightYAxis=t,this):this._rightYAxis}yAxisMin(){throw new Error("Not supported for this chart type")}yAxisMax(){throw new Error("Not supported for this chart type")}}const $t="dc-grid-item",Et="dc-grid-top";const Tt="dc-table-row";class zt extends(bt(xt)){constructor(t,e){super(t,e),this.configure({colorAccessor:t=>t||0,geoJsons:[]}),this._geoPath=g.geoPath(),this._projectionFlag=void 0,this._projection=void 0}configure(t){return super.configure(t),this}conf(){return this._conf}_doRender(){this.resetSvg();for(let t=0;t<this._conf.geoJsons.length;++t){let e=this.svg().append("g").attr("class",`layer${t}`).selectAll(`g.${this._geoJson(t).name}`).data(this._geoJson(t).data);e=e.enter().append("g").attr("class",this._geoJson(t).name).merge(e),e.append("path").attr("fill","white").attr("d",this._getGeoPath()),e.append("title"),this._plotData(t)}return this._projectionFlag=!1,this}_plotData(t){const e=this._generateLayeredData();if(this._isDataLayer(t)){const i=this._renderRegionG(t);this._renderPaths(i,t,e),this._renderTitles(i,t,e)}}_generateLayeredData(){const t={},e=this.data();for(let i=0;i<e.length;++i)t[this._conf.keyAccessor(e[i])]=e[i]._value;return t}_isDataLayer(t){return!!this._geoJson(t).keyAccessor}_renderRegionG(t){return this.svg().selectAll(this._layerSelector(t)).classed("selected",(e=>this._isSelected(t,e))).classed("deselected",(e=>this._isDeselected(t,e))).attr("class",(e=>{let i=`${this._geoJson(t).name} ${Z(this._geoJson(t).keyAccessor(e))}`;return this._isSelected(t,e)&&(i+=" selected"),this._isDeselected(t,e)&&(i+=" deselected"),i}))}_layerSelector(t){return`g.layer${t} g.${this._geoJson(t).name}`}_isSelected(t,e){return this.hasFilter()&&this.hasFilter(this._getKey(t,e))}_isDeselected(t,e){return this.hasFilter()&&!this.hasFilter(this._getKey(t,e))}_getKey(t,e){return this._geoJson(t).keyAccessor(e)}_geoJson(t){return this._conf.geoJsons[t]}_renderPaths(t,e,i){B(t.select("path").attr("fill",(function(){const t=h.select(this).attr("fill");return t||"none"})).on("click",((t,i)=>this.onClick(i,e))),this._conf.transitionDuration,this._conf.transitionDelay).attr("fill",((t,s)=>this._colorHelper.getColor(i[this._geoJson(e).keyAccessor(t)],s)))}onClick(t,e){const i=this._geoJson(e).keyAccessor(t);T.trigger((()=>{this.filter(i),this.redrawGroup()}))}_renderTitles(t,e,i){this._conf.renderTitle&&t.selectAll("title").text((t=>{const s=this._getKey(e,t),r=i[s];return this._conf.title({key:s,value:r})}))}_doRedraw(){for(let t=0;t<this._conf.geoJsons.length;++t)this._plotData(t),this._projectionFlag&&this.svg().selectAll(`g.${this._geoJson(t).name} path`).attr("d",this._getGeoPath());return this._projectionFlag=!1,this}projection(t){return arguments.length?(this._projection=t,this._projectionFlag=!0,this):this._projection}_getGeoPath(){return void 0===this._projection?(F.warn("choropleth projection default of geoAlbers is deprecated, in next version projection will need to be set explicitly"),this._geoPath.projection(g.geoAlbersUsa())):this._geoPath.projection(this._projection)}geoPath(){return this._geoPath}}class Ht extends(bt(vt)){constructor(t,e){super(t,e),this.configure({cols:void 0,rows:void 0,colOrdering:n.ascending,rowOrdering:n.ascending,xBorderRadius:6.75,yBorderRadius:6.75,colsLabel:t=>t,rowsLabel:t=>t,title:this._conf.colorAccessor,xAxisOnClick:t=>{this._filterAxis(0,t)},yAxisOnClick:t=>{this._filterAxis(1,t)},boxOnClick:t=>{const e=t.key;T.trigger((()=>{this.filter(new b(e)),this.redrawGroup()}))}}),this._chartBody=void 0,this._colScale=a.scaleBand(),this._rowScale=a.scaleBand(),this._mandatoryAttributes(["group"])}configure(t){return super.configure(t),this}conf(){return this._conf}_filterAxis(t,e){const i=this.selectAll(".box-group").filter((i=>i.key[t]===e)),s=i.filter((t=>!this.hasFilter(t.key)));T.trigger((()=>{const t=(s.empty()?i:s).data().map((t=>new b(t.key)));this.filter([t]),this.redrawGroup()}))}filter(t){const e=t=>(F.warnOnce("heatmap.filter taking a coordinate is deprecated - please pass dc.filters.TwoDimensionalFilter instead"),this.filter(new b(t)));return arguments.length?null===t||"TwoDimensionalFilter"===t.filterType||Array.isArray(t)&&Array.isArray(t[0])&&"TwoDimensionalFilter"===t[0][0].filterType?super.filter(t):e(t):super.filter()}_doRender(){return this.resetSvg(),this._chartBody=this.svg().append("g").attr("class","heatmap").attr("transform",`translate(${this.margins().left},${this.margins().top})`),this._doRedraw()}_doRedraw(){const t=this.data();let e=this._conf.rows||t.map((t=>t._value)),i=this._conf.cols||t.map(this._conf.keyAccessor);this._conf.rowOrdering&&(e=e.sort(this._conf.rowOrdering)),this._conf.colOrdering&&(i=i.sort(this._conf.colOrdering)),e=this._rowScale.domain(e),i=this._colScale.domain(i);const s=e.domain().length,r=i.domain().length,n=Math.floor(this.effectiveWidth()/r),a=Math.floor(this.effectiveHeight()/s);i.rangeRound([0,this.effectiveWidth()]),e.rangeRound([this.effectiveHeight(),0]);let o=this._chartBody.selectAll("g.box-group").data(this.data(),((t,e)=>`${this._conf.keyAccessor(t,e)}\0${t._value}`));o.exit().remove();const h=o.enter().append("g").attr("class","box-group");h.append("rect").attr("class","heat-box").attr("fill","white").attr("x",((t,e)=>i(this._conf.keyAccessor(t,e)))).attr("y",((t,i)=>e(t._value))).on("click",((t,e)=>this._conf.boxOnClick(e))),o=h.merge(o),this._conf.renderTitle&&(h.append("title"),o.select("title").text(this._conf.title)),B(o.select("rect"),this._conf.transitionDuration,this._conf.transitionDelay).attr("x",((t,e)=>i(this._conf.keyAccessor(t,e)))).attr("y",((t,i)=>e(t._value))).attr("rx",this._conf.xBorderRadius).attr("ry",this._conf.yBorderRadius).attr("fill",((t,e)=>this._colorHelper.getColor(t,e))).attr("width",n).attr("height",a);let l=this._chartBody.select("g.cols");l.empty()&&(l=this._chartBody.append("g").attr("class","cols axis"));let c=l.selectAll("text").data(i.domain());c.exit().remove(),c=c.enter().append("text").attr("x",(t=>i(t)+n/2)).style("text-anchor","middle").attr("y",this.effectiveHeight()).attr("dy",12).on("click",((t,e)=>this._conf.xAxisOnClick(e))).text(this._conf.colsLabel).merge(c),B(c,this._conf.transitionDuration,this._conf.transitionDelay).text(this._conf.colsLabel).attr("x",(t=>i(t)+n/2)).attr("y",this.effectiveHeight());let d=this._chartBody.select("g.rows");d.empty()&&(d=this._chartBody.append("g").attr("class","rows axis"));let _=d.selectAll("text").data(e.domain());if(_.exit().remove(),_=_.enter().append("text").style("text-anchor","end").attr("x",0).attr("dx",-2).attr("y",(t=>e(t)+a/2)).attr("dy",6).on("click",((t,e)=>this._conf.yAxisOnClick(e))).text(this._conf.rowsLabel).merge(_),B(_,this._conf.transitionDuration,this._conf.transitionDelay).text(this._conf.rowsLabel).attr("y",(t=>e(t)+a/2)),this.hasFilter()){const t=this;this.selectAll("g.box-group").each((function(e){t._isSelectedNode(e)?t.highlightSelected(this):t.fadeDeselected(this)}))}else{const t=this;this.selectAll("g.box-group").each((function(){t.resetHighlight(this)}))}return this}_isSelectedNode(t){return this.hasFilter(t.key)}}const Mt="yRef",Nt="xRef",Gt=1e-6;class Yt extends Rt{constructor(t,e){super(t,e),this.configure({transitionDuration:500,transitionDelay:0,label:t=>N(t.y0+t.y),renderLabel:!1,renderArea:!1}),this._dotRadius=5,this._dataPointRadius=null,this._dataPointFillOpacity=Gt,this._dataPointStrokeOpacity=Gt,this._curve=null,this._interpolate=null,this._tension=null,this._defined=void 0,this._dashStyle=void 0,this._xyTipsOn=!0,this._rangeBandPadding(1)}configure(t){return super.configure(t),this}conf(){return this._conf}plotData(){const t=this.chartBodyG();let e=t.select("g.stack-list");e.empty()&&(e=t.append("g").attr("class","stack-list"));let i=e.selectAll("g.stack").data(this.data());const s=i.enter().append("g").attr("class",((t,e)=>`stack _${e}`));i=s.merge(i),this._drawLine(s,i),this._drawArea(s,i),this._drawDots(t,i),this._conf.renderLabel&&this._drawLabels(i)}curve(t){return arguments.length?(this._curve=t,this):this._curve}interpolate(t){return F.warnOnce("dc.lineChart.interpolate has been deprecated since version 3.0 use dc.lineChart.curve instead"),arguments.length?(this._interpolate=t,this):this._interpolate}tension(t){return F.warnOnce("dc.lineChart.tension has been deprecated since version 3.0 use dc.lineChart.curve instead"),arguments.length?(this._tension=t,this):this._tension}defined(t){return arguments.length?(this._defined=t,this):this._defined}dashStyle(t){return arguments.length?(this._dashStyle=t,this):this._dashStyle}renderArea(t){return arguments.length?(this.configure({renderArea:t}),this):this._conf.renderArea}_getCurveFactory(){let t=null;if(this._curve)return this._curve;if("function"==typeof this._interpolate)t=this._interpolate;else{t={linear:f.curveLinear,"linear-closed":f.curveLinearClosed,step:f.curveStep,"step-before":f.curveStepBefore,"step-after":f.curveStepAfter,basis:f.curveBasis,"basis-open":f.curveBasisOpen,"basis-closed":f.curveBasisClosed,bundle:f.curveBundle,cardinal:f.curveCardinal,"cardinal-open":f.curveCardinalOpen,"cardinal-closed":f.curveCardinalClosed,monotone:f.curveMonotoneX}[this._interpolate]}return t||(t=f.curveLinear),null!==this._tension&&("function"!=typeof t.tension?F.warn("tension was specified but the curve/interpolate does not support it."):t=t.tension(this._tension)),t}_drawLine(t,e){const i=f.line().x((t=>this.x()(t.x))).y((t=>this.y()(t.y+t.y0))).curve(this._getCurveFactory());this._defined&&i.defined(this._defined);const s=t.append("path").attr("class","line").attr("stroke",((t,e)=>this._colorHelper.getColor(t,e)));this._dashStyle&&s.attr("stroke-dasharray",this._dashStyle),B(e.select("path.line"),this._conf.transitionDuration,this._conf.transitionDelay).attr("stroke",((t,e)=>this._colorHelper.getColor(t,e))).attr("d",(t=>this._safeD(i(t.values))))}_drawArea(t,e){if(this._conf.renderArea){const i=f.area().x((t=>this.x()(t.x))).y1((t=>this.y()(t.y+t.y0))).y0((t=>this.y()(t.y0))).curve(this._getCurveFactory());this._defined&&i.defined(this._defined),t.append("path").attr("class","area").attr("fill",((t,e)=>this._colorHelper.getColor(t,e))).attr("d",(t=>this._safeD(i(t.values)))),B(e.select("path.area"),this._conf.transitionDuration,this._conf.transitionDelay).attr("fill",((t,e)=>this._colorHelper.getColor(t,e))).attr("d",(t=>this._safeD(i(t.values))))}}_safeD(t){return!t||t.indexOf("NaN")>=0?"M0,0":t}_drawDots(t,e){if("always"===this.xyTipsOn()||!this._conf.brushOn&&!this._conf.parentBrushOn&&this.xyTipsOn()){const i="dc-tooltip-list";let s=t.select(`g.${i}`);s.empty()&&(s=t.append("g").attr("class",i)),e.each(((t,e)=>{let i=t.values;this._defined&&(i=i.filter(this._defined));let r=s.select(`g.dc-tooltip._${e}`);r.empty()&&(r=s.append("g").attr("class",`dc-tooltip _${e}`)),this._createRefLines(r);const n=r.selectAll("circle.dot").data(i,(t=>t.x)),a=this,o=n.enter().append("circle").attr("class","dot").attr("cx",(t=>J(this.x()(t.x)))).attr("cy",(t=>J(this.y()(t.y+t.y0)))).attr("r",this._getDotRadius()).style("fill-opacity",this._dataPointFillOpacity).style("stroke-opacity",this._dataPointStrokeOpacity).attr("fill",((t,e)=>this._colorHelper.getColor(t,e))).attr("stroke",((t,e)=>this._colorHelper.getColor(t,e))).on("mousemove",(function(){const t=h.select(this);a._showDot(t),a._showRefLines(t,r)})).on("mouseout",(function(){const t=h.select(this);a._hideDot(t),a._hideRefLines(r)})).merge(n);o.call((e=>this._doRenderTitle(e,t))),B(o,this._conf.transitionDuration).attr("cx",(t=>J(this.x()(t.x)))).attr("cy",(t=>J(this.y()(t.y+t.y0)))).attr("fill",((t,e)=>this._colorHelper.getColor(t,e))),n.exit().remove()}))}}_drawLabels(t){const e=this;t.each((function(t,i){const s=h.select(this).selectAll("text.lineLabel").data(t.values,(t=>t.x));B(s.enter().append("text").attr("class","lineLabel").attr("text-anchor","middle").merge(s),e._conf.transitionDuration).attr("x",(t=>J(e.x()(t.x)))).attr("y",(t=>J(e.y()(t.y+t.y0)-3))).text((t=>e._conf.label(t))),B(s.exit(),e._conf.transitionDuration).attr("height",0).remove()}))}_createRefLines(t){let e=t.select("path.yRef");e.empty()&&(e=t.append("path").attr("class",Mt)),e.style("display","none").attr("stroke-dasharray","5,5");let i=t.select("path.xRef");i.empty()&&(i=t.append("path").attr("class",Nt)),i.style("display","none").attr("stroke-dasharray","5,5")}_showDot(t){return t.style("fill-opacity",.8),t.style("stroke-opacity",.8),t.attr("r",this._dotRadius),t}_showRefLines(t,e){const i=t.attr("cx"),s=t.attr("cy"),r=`M${this._yAxisX()-this.margins().left} ${s}L${i} ${s}`,n=`M${i} ${this._yAxisHeight()}L${i} ${s}`;e.select("path.yRef").style("display","").attr("d",r),e.select("path.xRef").style("display","").attr("d",n)}_getDotRadius(){return this._dataPointRadius||this._dotRadius}_hideDot(t){t.style("fill-opacity",this._dataPointFillOpacity).style("stroke-opacity",this._dataPointStrokeOpacity).attr("r",this._getDotRadius())}_hideRefLines(t){t.select("path.yRef").style("display","none"),t.select("path.xRef").style("display","none")}_doRenderTitle(t,e){this._conf.renderTitle&&(t.select("title").remove(),t.append("title").text(H("data",this.titleFn(e.name))))}xyTipsOn(t){return arguments.length?(this._xyTipsOn=t,this):this._xyTipsOn}dotRadius(t){return arguments.length?(this._dotRadius=t,this):this._dotRadius}renderDataPoints(t){return arguments.length?(t?(this._dataPointFillOpacity=t.fillOpacity||.8,this._dataPointStrokeOpacity=t.strokeOpacity||0,this._dataPointRadius=t.radius||2):(this._dataPointFillOpacity=Gt,this._dataPointStrokeOpacity=Gt,this._dataPointRadius=null),this):{fillOpacity:this._dataPointFillOpacity,strokeOpacity:this._dataPointStrokeOpacity,radius:this._dataPointRadius}}_colorFilter(t,e,i){return function(){const s=h.select(this),r=s.attr("stroke")===t&&s.attr("stroke-dasharray")===(e instanceof Array?e.join(","):null)||s.attr("fill")===t;return i?!r:r}}legendHighlight(t){this.isLegendableHidden(t)||this.g().selectAll("path.line, path.area").classed("highlight",this._colorFilter(t.color,t.dashstyle)).classed("fadeout",this._colorFilter(t.color,t.dashstyle,!0))}legendReset(){this.g().selectAll("path.line, path.area").classed("highlight",!1).classed("fadeout",!1)}legendables(){const t=super.legendables();return this._dashStyle?t.map((t=>(t.dashstyle=this._dashStyle,t))):t}}const It="number-display";class Wt extends mt{constructor(t={}){super(Object.assign({cap:1/0,takeFront:!0,othersLabel:"Others",othersGrouper:(t,e)=>{const i=n.sum(e,(t=>t._value));return i>0?t.concat([{others:!0,key:this._conf.othersLabel,_value:i}]):t},ordering:t=>-t.value},t))}configure(t){return super.configure(t)}conf(){return super.conf()}data(){let t,e=M(super.data(),this._conf.ordering);if(this._conf.cap===1/0)return e;if(this._conf.cap)if(this._conf.takeFront)t=e.slice(this._conf.cap),e=e.slice(0,this._conf.cap);else{const i=Math.max(0,e.length-this._conf.cap);t=e.slice(0,i),e=e.slice(i)}return this._conf.othersGrouper?(this._restKeys=t.map((t=>t.key)),this._conf.othersGrouper(e,t)):e}filter(t){if(!arguments.length)return super.filter();if(t===this._conf.othersLabel){const t=[...this._restKeys,this._conf.othersLabel];return super.filter([t])}return super.filter(t)}}class Ut extends(bt(xt)){constructor(t,e){super(t,e),this.configure({colorAccessor:t=>this._conf.keyAccessor(t),emptyTitle:"empty",label:t=>this._conf.keyAccessor(t),renderLabel:!0,title:t=>`${this._conf.keyAccessor(t)}: ${t._value}`,transitionDuration:350,transitionDelay:0,radius:void 0,innerRadius:0,externalRadiusPadding:0,minAngleForLabel:.5,externalLabels:void 0,drawPaths:!1}),this.dataProvider(new Wt),this._sliceCssClass="pie-slice",this._labelCssClass="pie-label",this._sliceGroupCssClass="pie-slice-group",this._labelGroupCssClass="pie-label-group",this._emptyCssClass="empty-chart",this._computedRadius=void 0,this._g=void 0,this._cx=void 0,this._cy=void 0}configure(t){return super.configure(t),this}conf(){return this._conf}_doRender(){return this.resetSvg(),this._g=this.svg().append("g").attr("transform",`translate(${this.cx()},${this.cy()})`),this._g.append("g").attr("class",this._sliceGroupCssClass),this._g.append("g").attr("class",this._labelGroupCssClass),this._drawChart(),this}_drawChart(){const t=n.min([this.width(),this.height()])/2;this._computedRadius=this._conf.radius&&this._conf.radius<t?this._conf.radius:t;const e=this._buildArcs(),i=this._pieLayout();let s;if(n.sum(this.data(),(t=>t._value))?(s=i(this.data()),this._g.classed(this._emptyCssClass,!1)):(s=i([{key:this._conf.emptyTitle,_value:1,others:[this._conf.emptyTitle]}]),this._g.classed(this._emptyCssClass,!0)),this._g){const t=this._g.select(`g.${this._sliceGroupCssClass}`).selectAll(`g.${this._sliceCssClass}`).data(s),i=this._g.select(`g.${this._labelGroupCssClass}`).selectAll(`text.${this._labelCssClass}`).data(s);this._removeElements(t,i),this._createElements(t,i,e,s),this._updateElements(s,e),this._highlightFilter(),B(this._g,this._conf.transitionDuration,this._conf.transitionDelay).attr("transform",`translate(${this.cx()},${this.cy()})`)}}_createElements(t,e,i,s){const r=this._createSliceNodes(t);this._createSlicePath(r,i),this._createTitles(r),this._createLabels(e,s,i)}_createSliceNodes(t){return t.enter().append("g").attr("class",((t,e)=>`${this._sliceCssClass} _${e}`))}_createSlicePath(t,e){const i=B(t.append("path").attr("fill",((t,e)=>this._fill(t,e))).on("click",((t,e)=>this._onClick(e))).attr("d",((t,i)=>this._safeArc(t,i,e))),this._conf.transitionDuration,this._conf.transitionDelay);if(i.attrTween){const t=this;i.attrTween("d",(function(e){return t._tweenPie(e,this)}))}}_createTitles(t){this._conf.renderTitle&&t.append("title").text((t=>this._conf.title(t.data)))}_applyLabelText(t){t.text((t=>{const e=t.data;return!this._sliceHasNoData(e)&&!this._sliceTooSmall(t)||this._isSelectedSlice(t)?this._conf.label(t.data):""}))}_positionLabels(t,e){this._applyLabelText(t),B(t,this._conf.transitionDuration,this._conf.transitionDelay).attr("transform",(t=>this._labelPosition(t,e))).attr("text-anchor","middle")}_highlightSlice(t,e){this.select(`g.pie-slice._${t}`).classed("highlight",e)}_createLabels(t,e,i){if(this._conf.renderLabel){const s=t.enter().append("text").attr("class",((t,e)=>{let i=`${this._sliceCssClass} ${this._labelCssClass} _${e}`;return this._conf.externalLabels&&(i+=" external"),i})).on("click",((t,e)=>this._onClick(e))).on("mouseover",((t,e)=>{this._highlightSlice(e.index,!0)})).on("mouseout",((t,e)=>{this._highlightSlice(e.index,!1)}));this._positionLabels(s,i),this._conf.externalLabels&&this._conf.drawPaths&&this._updateLabelPaths(e,i)}}_updateLabelPaths(t,e){let i=this._g.selectAll(`polyline.${this._sliceCssClass}`).data(t);i.exit().remove(),i=i.enter().append("polyline").attr("class",((t,e)=>`pie-path _${e} ${this._sliceCssClass}`)).on("click",((t,e)=>this._onClick(e))).on("mouseover",((t,e)=>{this._highlightSlice(e.index,!0)})).on("mouseout",((t,e)=>{this._highlightSlice(e.index,!1)})).merge(i);const s=f.arc().outerRadius(this._computedRadius-this._conf.externalRadiusPadding+this._conf.externalLabels).innerRadius(this._computedRadius-this._conf.externalRadiusPadding),r=B(i,this._conf.transitionDuration,this._conf.transitionDelay);r.attrTween?r.attrTween("points",(function(t){let i=this._current||t;i={startAngle:i.startAngle,endAngle:i.endAngle};const r=o.interpolate(i,t);return this._current=r(0),t=>{const i=r(t);return[e.centroid(i),s.centroid(i)]}})):r.attr("points",(t=>[e.centroid(t),s.centroid(t)])),r.style("visibility",(t=>t.endAngle-t.startAngle<1e-4?"hidden":"visible"))}_updateElements(t,e){this._updateSlicePaths(t,e),this._updateLabels(t,e),this._updateTitles(t)}_updateSlicePaths(t,e){const i=B(this._g.selectAll(`g.${this._sliceCssClass}`).data(t).select("path").attr("d",((t,i)=>this._safeArc(t,i,e))),this._conf.transitionDuration,this._conf.transitionDelay);if(i.attrTween){const t=this;i.attrTween("d",(function(e){return t._tweenPie(e,this)}))}i.attr("fill",((t,e)=>this._fill(t,e)))}_updateLabels(t,e){if(this._conf.renderLabel){const i=this._g.selectAll(`text.${this._labelCssClass}`).data(t);this._positionLabels(i,e),this._conf.externalLabels&&this._conf.drawPaths&&this._updateLabelPaths(t,e)}}_updateTitles(t){this._conf.renderTitle&&this._g.selectAll(`g.${this._sliceCssClass}`).data(t).select("title").text((t=>this._conf.title(t.data)))}_removeElements(t,e){t.exit().remove(),e.exit().remove()}_highlightFilter(){const t=this;this.hasFilter()?this.selectAll(`g.${this._sliceCssClass}`).each((function(e){t._isSelectedSlice(e)?t.highlightSelected(this):t.fadeDeselected(this)})):this.selectAll(`g.${this._sliceCssClass}`).each((function(){t.resetHighlight(this)}))}cx(t){return arguments.length?(this._cx=t,this):this._cx||this.width()/2}cy(t){return arguments.length?(this._cy=t,this):this._cy||this.height()/2}_buildArcs(){return f.arc().outerRadius(this._computedRadius-this._conf.externalRadiusPadding).innerRadius(this._conf.innerRadius)}_isSelectedSlice(t){return this.hasFilter(this._conf.keyAccessor(t.data))}_doRedraw(){return this._drawChart(),this}_pieLayout(){return f.pie().sort(null).value((t=>t._value))}_sliceTooSmall(t){const e=t.endAngle-t.startAngle;return isNaN(e)||e<this._conf.minAngleForLabel}_sliceHasNoData(t){return 0===t._value}_isOffCanvas(t){return!t||isNaN(t.startAngle)||isNaN(t.endAngle)}_fill(t,e){return this._colorHelper.getColor(t.data,e)}_onClick(t){this._g.attr("class")!==this._emptyCssClass&&this.onClick(t.data)}_safeArc(t,e,i){let s=i(t,e);return s.indexOf("NaN")>=0&&(s="M0,0"),s}_labelPosition(t,e){let i;return i=this._conf.externalLabels?f.arc().outerRadius(this._computedRadius-this._conf.externalRadiusPadding+this._conf.externalLabels).innerRadius(this._computedRadius-this._conf.externalRadiusPadding+this._conf.externalLabels).centroid(t):e.centroid(t),isNaN(i[0])||isNaN(i[1])?"translate(0,0)":`translate(${i})`}legendables(){return this.data().map(((t,e)=>{const i={name:t.key,data:t.value,others:t.others,chart:this};return i.color=this._colorHelper.getColor(t,e),i}))}legendHighlight(t){this._highlightSliceFromLegendable(t,!0)}legendReset(t){this._highlightSliceFromLegendable(t,!1)}legendToggle(t){this.onClick({key:t.name,others:t.others})}_highlightSliceFromLegendable(t,e){this.selectAll("g.pie-slice").each((function(i){t.name===i.data.key&&h.select(this).classed("highlight",e)}))}_tweenPie(t,e){t.innerRadius=this._conf.innerRadius;let i=e._current;i=this._isOffCanvas(i)?{startAngle:0,endAngle:0}:{startAngle:i.startAngle,endAngle:i.endAngle};const s=o.interpolate(i,t);return e._current=s(0),t=>this._safeArc(s(t),0,this._buildArcs())}}class Vt extends(bt(vt)){constructor(t,e){super(t,e),this.configure({label:t=>this._conf.keyAccessor(t),renderLabel:!0,title:t=>`${this._conf.keyAccessor(t)}: ${t._value}`,labelOffsetX:10,labelOffsetY:void 0,titleLabelOffsetX:2,gap:5,fixedBarHeight:void 0,renderTitleLabel:!1,elasticX:void 0}),this.dataProvider(new Wt),this._g=void 0,this._dyOffset="0.35em",this._rowCssClass="dc_row",this._titleRowCssClass="titlerow",this._x=void 0,this._xAxis=d.axisBottom(void 0),this._rowData=void 0}configure(t){return super.configure(t),this}conf(){return this._conf}_calculateAxisScale(){if(!this._x||this._conf.elasticX){const t=n.extent(this._rowData,(t=>t._value));t[0]>0&&(t[0]=0),t[1]<0&&(t[1]=0),this._x=a.scaleLinear().domain(t).range([0,this.effectiveWidth()])}this._xAxis.scale(this._x)}_drawAxis(){let t=this._g.select("g.axis");this._calculateAxisScale(),t.empty()&&(t=this._g.append("g").attr("class","axis")),t.attr("transform",`translate(0, ${this.effectiveHeight()})`),B(t,this._conf.transitionDuration,this._conf.transitionDelay).call(this._xAxis)}_doRender(){return this.resetSvg(),this._g=this.svg().append("g").attr("transform",`translate(${this.margins().left},${this.margins().top})`),this._drawChart(),this}x(t){return arguments.length?(this._x=t,this):this._x}_drawGridLines(){this._g.selectAll("g.tick").select("line.grid-line").remove(),this._g.selectAll("g.tick").append("line").attr("class","grid-line").attr("x1",0).attr("y1",0).attr("x2",0).attr("y2",(()=>-this.effectiveHeight()))}_drawChart(){this._rowData=this.data(),this._drawAxis(),this._drawGridLines();let t=this._g.selectAll(`g.${this._rowCssClass}`).data(this._rowData);this._removeElements(t),t=this._createElements(t).merge(t),this._updateElements(t)}_createElements(t){const e=t.enter().append("g").attr("class",((t,e)=>`${this._rowCssClass} _${e}`));return e.append("rect").attr("width",0),this._createLabels(e),e}_removeElements(t){t.exit().remove()}_rootValue(){const t=this._x(0);return t===-1/0||t!=t?this._x(1):t}_updateElements(t){const e=this._rowData.length;let i;i=this._conf.fixedBarHeight?this._conf.fixedBarHeight:(this.effectiveHeight()-(e+1)*this._conf.gap)/e,this._labelOffsetY=void 0===this._conf.labelOffsetY?i/2:this._conf.labelOffsetY;B(t.attr("transform",((t,e)=>`translate(0,${(e+1)*this._conf.gap+e*i})`)).select("rect").attr("height",i).attr("fill",((t,e)=>this._colorHelper.getColor(t,e))).on("click",((t,e)=>this._onClick(e))).classed("deselected",(t=>!!this.hasFilter()&&!this._isSelectedRow(t))).classed("selected",(t=>!!this.hasFilter()&&this._isSelectedRow(t))),this._conf.transitionDuration,this._conf.transitionDelay).attr("width",(t=>Math.abs(this._rootValue()-this._x(t._value)))).attr("transform",(t=>this._translateX(t))),this._createTitles(t),this._updateLabels(t)}_createTitles(t){this._conf.renderTitle&&(t.select("title").remove(),t.append("title").text(this._conf.title))}_createLabels(t){this._conf.renderLabel&&t.append("text").on("click",((t,e)=>this._onClick(e))),this._conf.renderTitleLabel&&t.append("text").attr("class",this._titleRowCssClass).on("click",((t,e)=>this._onClick(e)))}_updateLabels(t){if(this._conf.renderLabel){B(t.select("text").attr("x",this._conf.labelOffsetX).attr("y",this._labelOffsetY).attr("dy",this._dyOffset).on("click",((t,e)=>this._onClick(e))).attr("class",((t,e)=>`${this._rowCssClass} _${e}`)).text((t=>this._conf.label(t))),this._conf.transitionDuration,this._conf.transitionDelay).attr("transform",(t=>this._translateX(t)))}if(this._conf.renderTitleLabel){B(t.select(`.${this._titleRowCssClass}`).attr("x",this.effectiveWidth()-this._conf.titleLabelOffsetX).attr("y",this._labelOffsetY).attr("dy",this._dyOffset).attr("text-anchor","end").on("click",((t,e)=>this._onClick(e))).attr("class",((t,e)=>`${this._titleRowCssClass} _${e}`)).text((t=>this._conf.title(t))),this._conf.transitionDuration,this._conf.transitionDelay).attr("transform",(t=>this._translateX(t)))}}_onClick(t,e){this.onClick(t,e)}_translateX(t){const e=this._x(t._value),i=this._rootValue();return`translate(${e>i?i:e},0)`}_doRedraw(){return this._drawChart(),this}xAxis(t){return arguments.length?(this._xAxis=t,this):this._xAxis}_isSelectedRow(t){return this.hasFilter(this._conf.keyAccessor(t))}}const Xt="dc-select-option";class qt extends(bt(xt)){constructor(t,e){super(t,e),this.configure({colorAccessor:t=>this._conf.keyAccessor(t),label:t=>this._conf.keyAccessor(t),renderLabel:!0,title:t=>`${this._conf.keyAccessor(t)}: ${this._extendedValueAccessor(t)}`,transitionDuration:350,emptyTitle:"empty",radius:void 0,innerRadius:0,ringSizes:this.defaultRingSizes(),minAngleForLabel:.5,externalLabels:void 0}),this.dataProvider().configure({ordering:t=>t.key}),this._sliceCssClass="pie-slice",this._emptyCssClass="empty-chart",this._computedRadius=void 0,this._g=void 0,this._cx=void 0,this._cy=void 0}configure(t){return super.configure(t),this}conf(){return this._conf}_extendedValueAccessor(t){return t.path?t.value:t._value}_scaleRadius(t,e){if(0===t)return this._conf.innerRadius;{const i=n.sum(this._relativeRingSizes.slice(0,t)),s=t*(1/this._relativeRingSizes.length)/i,r=(e-this._rootOffset)/(1-this._rootOffset)*(this._computedRadius-this._conf.innerRadius);return this._conf.innerRadius+r/s}}_doRender(){return this.resetSvg(),this._g=this.svg().append("g").attr("transform",`translate(${this.cx()},${this.cy()})`),this._drawChart(),this}_drawChart(){const t=n.min([this.width(),this.height()])/2;this._computedRadius=this._conf.radius&&this._conf.radius<t?this._conf.radius:t;const e=this._buildArcs();let i,s;if(n.sum(this.data(),(t=>t._value))?(s=tt(this.data(),(t=>t._value)),i=this._partitionNodes(s),i.nodes.shift(),this._g.classed(this._emptyCssClass,!1)):(s=tt([],(t=>t.value)),i=this._partitionNodes(s),this._g.classed(this._emptyCssClass,!0)),this._rootOffset=i.rootOffset,this._relativeRingSizes=i.relativeRingSizes,this._g){const t=this._g.selectAll(`g.${this._sliceCssClass}`).data(i.nodes);this._createElements(t,e,i.nodes),this._updateElements(i.nodes,e),this._removeElements(t),this._highlightFilter(),B(this._g,this._conf.transitionDuration,this._conf.transitionDelay).attr("transform",`translate(${this.cx()},${this.cy()})`)}}_createElements(t,e,i){const s=this._createSliceNodes(t);this._createSlicePath(s,e),this._createTitles(s),this._createLabels(i,e)}_createSliceNodes(t){return t.enter().append("g").attr("class",((t,e)=>`${this._sliceCssClass} _${e} ${this._sliceCssClass}-level-${t.depth}`))}_createSlicePath(t,e){const i=B(t.append("path").attr("fill",((t,e)=>this._fill(t,e))).on("click",((t,e)=>this.onClick(e))).attr("d",(t=>this._safeArc(e,t))),this._conf.transitionDuration);if(i.attrTween){const t=this;i.attrTween("d",(function(e){return t._tweenSlice(e,this)}))}}_createTitles(t){this._conf.renderTitle&&t.append("title").text((t=>this._conf.title(t)))}_positionLabels(t,e){B(t,this._conf.transitionDuration).attr("transform",(t=>this._labelPosition(t,e))).attr("text-anchor","middle").text((t=>this._sliceHasNoData(t)||this._sliceTooSmall(t)?"":this._conf.label(t)))}_createLabels(t,e){if(this._conf.renderLabel){const i=this._g.selectAll(`text.${this._sliceCssClass}`).data(t);i.exit().remove();const s=i.enter().append("text").attr("class",((t,e)=>{let i=`${this._sliceCssClass} _${e}`;return this._conf.externalLabels&&(i+=" external"),i})).on("click",((t,e)=>this.onClick(e)));this._positionLabels(s,e)}}_updateElements(t,e){this._updateSlicePaths(t,e),this._updateLabels(t,e),this._updateTitles(t)}_updateSlicePaths(t,e){const i=B(this._g.selectAll(`g.${this._sliceCssClass}`).data(t).select("path").attr("d",((t,i)=>this._safeArc(e,t))),this._conf.transitionDuration);if(i.attrTween){const t=this;i.attrTween("d",(function(e){return t._tweenSlice(e,this)}))}i.attr("fill",((t,e)=>this._fill(t,e)))}_updateLabels(t,e){if(this._conf.renderLabel){const i=this._g.selectAll(`text.${this._sliceCssClass}`).data(t);this._positionLabels(i,e)}}_updateTitles(t){this._conf.renderTitle&&this._g.selectAll(`g.${this._sliceCssClass}`).data(t).select("title").text((t=>this._conf.title(t)))}_removeElements(t){t.exit().remove()}_highlightFilter(){const t=this;t.hasFilter()?t.selectAll(`g.${t._sliceCssClass}`).each((function(e){t._isSelectedSlice(e)?t.highlightSelected(this):t.fadeDeselected(this)})):t.selectAll(`g.${t._sliceCssClass}`).each((function(e){t.resetHighlight(this)}))}cx(t){return arguments.length?(this._cx=t,this):this._cx||this.width()/2}cy(t){return arguments.length?(this._cy=t,this):this._cy||this.height()/2}defaultRingSizes(){return{partitionDy:()=>this._computedRadius*this._computedRadius,scaleInnerRadius:t=>t.data.path&&1===t.data.path.length?this._conf.innerRadius:Math.sqrt(t.y0),scaleOuterRadius:t=>Math.sqrt(t.y1),relativeRingSizesFunction:()=>[]}}equalRingSizes(){return this.relativeRingSizes((t=>{const e=[];for(let i=0;i<t;i++)e.push(1/t);return e}))}relativeRingSizes(t){return{partitionDy:()=>1,scaleInnerRadius:t=>this._scaleRadius(t.data.path.length-1,t.y0),scaleOuterRadius:t=>this._scaleRadius(t.data.path.length,t.y1),relativeRingSizesFunction:e=>{const i=t(e);return function(t,e){if(!Array.isArray(t))throw new v("relativeRingSizes function must return an array");const i=n.sum(t);if(Math.abs(i-1)>R.NEGLIGIBLE_NUMBER)throw new v(`relativeRingSizes : portions must add up to 1, but sum was ${i}`);if(t.length!==e)throw new v(`relativeRingSizes : number of values must match number of rings (${e}) but was ${t.length}`)}(i,e),i}}}_buildArcs(){return f.arc().startAngle((t=>t.x0)).endAngle((t=>t.x1)).innerRadius((t=>this._conf.ringSizes.scaleInnerRadius(t))).outerRadius((t=>this._conf.ringSizes.scaleOuterRadius(t)))}_isSelectedSlice(t){return this._isPathFiltered(t.path)}_isPathFiltered(t){for(let e=0;e<this.filters().length;e++){if(this.filters()[e].isFiltered(t))return!0}return!1}_filtersForPath(t){const e=new m(t),i=[];for(let s=0;s<this.filters().length;s++){const r=this.filters()[s];(r.isFiltered(t)||e.isFiltered(r))&&i.push(r)}return i}_doRedraw(){return this._drawChart(),this}_partitionNodes(t){const e=function(t){return{key:t.data.key,value:t.value}},i=this.dataProvider().conf().ordering,s=y.hierarchy(t).sum((t=>t.children?0:this._extendedValueAccessor(t))).sort(((t,s)=>n.ascending(i(e(t)),i(e(s)))));y.partition().size([2*Math.PI,this._conf.ringSizes.partitionDy()])(s);const r=s.descendants().map((t=>(t.key=t.data.key,t.path=t.data.path,t))),a=this._conf.ringSizes.relativeRingSizesFunction(s.height);return{nodes:r,rootOffset:s.y1,relativeRingSizes:a}}_sliceTooSmall(t){const e=t.x1-t.x0;return isNaN(e)||e<this._conf.minAngleForLabel}_sliceHasNoData(t){return 0===this._extendedValueAccessor(t)}_isOffCanvas(t){return!t||isNaN(t.x0)||isNaN(t.y0)}_fill(t,e){return this._colorHelper.getColor(t.data,e)}onClick(t,e){if(this._g.attr("class")===this._emptyCssClass)return;const i=t.path||t.key,s=new m(i),r=this._filtersForPath(i);let n=!1;for(let t=r.length-1;t>=0;t--){it(r[t],i)&&(n=!0),this.filter(r[t])}T.trigger((()=>{n||this.filter(s),this.redrawGroup()}))}_safeArc(t,e){let i=t(e);return i.indexOf("NaN")>=0&&(i="M0,0"),i}_labelPosition(t,e){let i;return i=this._conf.externalLabels?f.arc().outerRadius(this._computedRadius+this._conf.externalLabels).innerRadius(this._computedRadius+this._conf.externalLabels).centroid(t):e.centroid(t),isNaN(i[0])||isNaN(i[1])?"translate(0,0)":`translate(${i})`}legendables(){return this.data().map(((t,e)=>{const i={name:t.key,data:t.value,others:t.others,chart:this};return i.color=this._colorHelper.getColor(t,e),i}))}legendHighlight(t){this._highlightSliceFromLegendable(t,!0)}legendReset(t){this._highlightSliceFromLegendable(t,!1)}legendToggle(t){this.onClick({key:t.name,others:t.others})}_highlightSliceFromLegendable(t,e){this.selectAll("g.pie-slice").each((function(i){t.name===i.key&&h.select(this).classed("highlight",e)}))}_tweenSlice(t,e){let i=e._current;this._isOffCanvas(i)&&(i={x0:0,x1:0,y0:0,y1:0});const s={x0:t.x0,x1:t.x1,y0:t.y0,y1:t.y1},r=o.interpolate(i,s);return e._current=r(0),e=>this._safeArc(this._buildArcs(),Object.assign({},t,r(e)))}}t.AbstractColorHelper=ot,t.BadArgumentException=v,t.BarChart=class extends Rt{constructor(t,e){super(t,e),this.configure({label:t=>N(t.y0+t.y),renderLabel:!1,centerBar:!1,alwaysUseRounding:!1}),this._gap=2,this._barWidth=void 0}configure(t){return super.configure(t),this}conf(){return this._conf}outerPadding(t){return arguments.length?this._outerRangeBandPadding(t):this._outerRangeBandPadding()}rescale(){return super.rescale(),this._barWidth=void 0,this}render(){return this._conf.round&&this._conf.centerBar&&!this._conf.alwaysUseRounding&&F.warn("By default, brush rounding is disabled if bars are centered. See dc.js bar chart API documentation for details."),super.render()}plotData(){let t=this.chartBodyG().selectAll("g.stack").data(this.data());this._calculateBarWidth(),t=t.enter().append("g").attr("class",((t,e)=>`stack _${e}`)).merge(t);const e=t.size()-1;{const i=this;t.each((function(t,s){const r=h.select(this);i._renderBars(r,s,t),i._conf.renderLabel&&e===s&&i._renderLabels(r,s,t)}))}}_barHeight(t){return J(Math.abs(this.y()(t.y+t.y0)-this.y()(t.y0)))}_labelXPos(t){let e=this.x()(t.x);return this._conf.centerBar||(e+=this._barWidth/2),this.isOrdinal()&&void 0!==this._gap&&(e+=this._gap/2),J(e)}_labelYPos(t){let e=this.y()(t.y+t.y0);return t.y<0&&(e-=this._barHeight(t)),J(e-3)}_renderLabels(t,e,i){const s=t.selectAll("text.barLabel").data(i.values,(t=>t.x)),r=s.enter().append("text").attr("class","barLabel").attr("text-anchor","middle").attr("x",(t=>this._labelXPos(t))).attr("y",(t=>this._labelYPos(t))).merge(s);this.isOrdinal()&&(r.on("click",((t,e)=>this.onClick(e))),r.attr("cursor","pointer")),B(r,this._conf.transitionDuration,this._conf.transitionDelay).attr("x",(t=>this._labelXPos(t))).attr("y",(t=>this._labelYPos(t))).text((t=>this._conf.label(t))),B(s.exit(),this._conf.transitionDuration,this._conf.transitionDelay).attr("height",0).remove()}_barXPos(t){let e=this.x()(t.x);return this._conf.centerBar&&(e-=this._barWidth/2),this.isOrdinal()&&void 0!==this._gap&&(e+=this._gap/2),J(e)}_renderBars(t,e,i){const s=t.selectAll("rect.bar").data(i.values,(t=>t.x)),r=s.enter().append("rect").attr("class","bar").attr("fill",((t,e)=>this._colorHelper.getColor(t,e))).attr("x",(t=>this._barXPos(t))).attr("y",this._yAxisHeight()).attr("height",0),n=r.merge(s);this._conf.renderTitle&&r.append("title").text(H("data",this.titleFn(i.name))),this.isOrdinal()&&n.on("click",((t,e)=>this.onClick(e))),B(n,this._conf.transitionDuration,this._conf.transitionDelay).attr("x",(t=>this._barXPos(t))).attr("y",(t=>{let e=this.y()(t.y+t.y0);return t.y<0&&(e-=this._barHeight(t)),J(e)})).attr("width",this._barWidth).attr("height",(t=>this._barHeight(t))).attr("fill",((t,e)=>this._colorHelper.getColor(t,e))).select("title").text(H("data",this.titleFn(i.name))),B(s.exit(),this._conf.transitionDuration,this._conf.transitionDelay).attr("x",(t=>this.x()(t.x))).attr("width",.9*this._barWidth).remove()}_calculateBarWidth(){if(void 0===this._barWidth){const t=this.xUnitCount();this.isOrdinal()&&void 0===this._gap?this._barWidth=Math.floor(this.x().bandwidth()):this._gap?this._barWidth=Math.floor((this._xAxisLength()-(t-1)*this._gap)/t):this._barWidth=Math.floor(this._xAxisLength()/(1+this.barPadding())/t),(this._barWidth===1/0||isNaN(this._barWidth)||this._barWidth<1)&&(this._barWidth=1)}}fadeDeselectedArea(t){const e=this.chartBodyG().selectAll("rect.bar");if(this.isOrdinal())this.hasFilter()?(e.classed(R.SELECTED_CLASS,(t=>this.hasFilter(t.x))),e.classed(R.DESELECTED_CLASS,(t=>!this.hasFilter(t.x)))):(e.classed(R.SELECTED_CLASS,!1),e.classed(R.DESELECTED_CLASS,!1));else if(this._conf.brushOn||this._conf.parentBrushOn)if(this._brushIsEmpty(t))e.classed(R.DESELECTED_CLASS,!1);else{const i=t[0],s=t[1];e.classed(R.DESELECTED_CLASS,(t=>t.x<i||t.x>=s))}}onClick(t,e){super.onClick(t.data,e)}barPadding(t){return arguments.length?(this._rangeBandPadding(t),this._gap=void 0,this):this._rangeBandPadding()}_useOuterPadding(){return void 0===this._gap}gap(t){return arguments.length?(this._gap=t,this):this._gap}_extendBrush(t){return t&&this._conf.round&&(!this._conf.centerBar||this._conf.alwaysUseRounding)&&(t[0]=this._conf.round(t[0]),t[1]=this._conf.round(t[1])),t}legendHighlight(t){const e=(t,e)=>function(){const i=h.select(this).attr("fill")===t;return e?!i:i};this.isLegendableHidden(t)||this.g().selectAll("rect.bar").classed("highlight",e(t.color)).classed("fadeout",e(t.color,!0))}legendReset(){this.g().selectAll("rect.bar").classed("highlight",!1).classed("fadeout",!1)}xAxisMax(){let t=super.xAxisMax();if("resolution"in this._conf.xUnits){t+=this._conf.xUnits.resolution}return t}},t.BaseMixin=xt,t.BoxPlot=class extends St{constructor(t,e){super(t,e);var i;this._whiskers=(i=1.5,t=>{const e=t.quartiles[0],s=t.quartiles[2],r=(s-e)*i;let n=-1,a=t.length;do{++n}while(t[n]<e-r);do{--a}while(t[a]>s+r);return[n,a]}),this._box=_t(),this.configure({xUnits:at,tickFormat:null,renderDataPoints:!1,dataOpacity:.3,dataWidthPortion:.8,showOutliers:!0,boldOutlier:!1,yRangePadding:8}),this._boxWidth=(t,e)=>this.isOrdinal()?this.x().bandwidth():t/(1+this.boxPadding())/e,this.x(a.scaleBand()),this.boxPadding(.8),this.outerPadding(.5)}configure(t){return super.configure(t),this}conf(){return this._conf}data(){return super.data().map((t=>(t.map=e=>e.call(t,t),t))).filter((t=>0!==t._value.length))}boxPadding(t){return arguments.length?this._rangeBandPadding(t):this._rangeBandPadding()}outerPadding(t){return arguments.length?this._outerRangeBandPadding(t):this._outerRangeBandPadding()}boxWidth(t){return arguments.length?(this._boxWidth="function"==typeof t?t:()=>t,this):this._boxWidth}_boxTransform(t,e){return`translate(${this.x()(this._conf.keyAccessor(t,e))}, 0)`}_preprocessData(){this._conf.elasticX&&this.x().domain([])}plotData(){const t=this._boxWidth(this.effectiveWidth(),this.xUnitCount());this._box.whiskers(this._whiskers).width(t).height(this.effectiveHeight()).value((t=>t._value)).domain(this.y().domain()).duration(this._conf.transitionDuration).tickFormat(this._conf.tickFormat).renderDataPoints(this._conf.renderDataPoints).dataOpacity(this._conf.dataOpacity).dataWidthPortion(this._conf.dataWidthPortion).renderTitle(this._conf.renderTitle).showOutliers(this._conf.showOutliers).boldOutlier(this._conf.boldOutlier);const e=this.chartBodyG().selectAll("g.box").data(this.data(),this._conf.keyAccessor),i=this._renderBoxes(e);this._updateBoxes(i),this._removeBoxes(e),this.fadeDeselectedArea(this.filter())}_renderBoxes(t){const e=t.enter().append("g");return e.attr("class","box").attr("transform",((t,e)=>this._boxTransform(t,e))).call(this._box).on("click",((t,e)=>{this.filter(this._conf.keyAccessor(e)),this.redrawGroup()})),e.merge(t)}_updateBoxes(t){const e=this;B(t,this._conf.transitionDuration,this._conf.transitionDelay).attr("transform",((t,e)=>this._boxTransform(t,e))).call(this._box).each((function(t){const i=e._colorHelper.getColor(t,0);h.select(this).select("rect.box").attr("fill",i),h.select(this).selectAll("circle.data").attr("fill",i)}))}_removeBoxes(t){t.exit().remove().call(this._box)}_minDataValue(){return n.min(this.data(),(t=>n.min(t._value)))}_maxDataValue(){return n.max(this.data(),(t=>n.max(t._value)))}_yAxisRangeRatio(){return(this._maxDataValue()-this._minDataValue())/this.effectiveHeight()}fadeDeselectedArea(t){const e=this;if(this.hasFilter())if(this.isOrdinal())this.g().selectAll("g.box").each((function(t){e.isSelectedNode(t)?e.highlightSelected(this):e.fadeDeselected(this)}));else{if(!this._conf.brushOn&&!this._conf.parentBrushOn)return;const i=t[0],s=t[1];this.g().selectAll("g.box").each((function(t){const r=e._conf.keyAccessor(t);r<i||r>=s?e.fadeDeselected(this):e.highlightSelected(this)}))}else this.g().selectAll("g.box").each((function(){e.resetHighlight(this)}))}isSelectedNode(t){return this.hasFilter(this._conf.keyAccessor(t))}yAxisMin(){const t=this._conf.yRangePadding*this._yAxisRangeRatio();return I(this._minDataValue()-t,this._conf.yAxisPadding)}yAxisMax(){const t=this._conf.yRangePadding*this._yAxisRangeRatio();return Y(this._maxDataValue()+t,this._conf.yAxisPadding)}},t.BubbleChart=Dt,t.BubbleMixin=At,t.BubbleOverlay=Pt,t.CFDataCapHelper=Wt,t.CFFilterHandler=pt,t.CFMultiAdapter=Lt,t.CFSimpleAdapter=mt,t.CboxMenu=class extends xt{constructor(t,e){super(t,e),this.configure({multiple:!1,promptText:"Select all",promptValue:null,filterDisplayed:t=>t._value>0,order:(t,e)=>n.ascending(this._conf.keyAccessor(t),this._conf.keyAccessor(e))}),this._cbox=void 0,this._uniqueId=j()}configure(t){return super.configure(t),this}conf(){return this._conf}data(){return super.data().filter(this._conf.filterDisplayed)}_doRender(){return this._doRedraw()}_doRedraw(){return this.select("ul").remove(),this._cbox=this.root().append("ul").classed("dc-cbox-group",!0),this._renderOptions(),this.hasFilter()&&this._conf.multiple?this._cbox.selectAll("input").property("checked",(t=>t&&this.filters().indexOf(String(this._conf.keyAccessor(t)))>=0||!1)):this.hasFilter()&&this._cbox.selectAll("input").property("checked",(t=>!!t&&this._conf.keyAccessor(t)===this.filter())),this}_renderOptions(){const t=this._conf.multiple?"checkbox":"radio";let e=this._cbox.selectAll("li.dc-cbox-item").data(this.data(),(t=>this._conf.keyAccessor(t)));e.exit().remove(),e=e.enter().append("li").classed(Ot,!0).merge(e),e.append("input").attr("type",t).attr("value",(t=>this._conf.keyAccessor(t))).attr("name",`domain_${this._uniqueId}`).attr("id",((t,e)=>`input_${this._uniqueId}_${e}`)),e.append("label").attr("for",((t,e)=>`input_${this._uniqueId}_${e}`)).text(this._conf.title);const i=this;if(this._conf.multiple)this._cbox.append("li").append("input").attr("type","reset").text(this._conf.promptText).on("click",(function(t,e){return i._onChange(e,t,this)}));else{const e=this._cbox.append("li");e.append("input").attr("type",t).attr("value",this._conf.promptValue).attr("name",`domain_${this._uniqueId}`).attr("id",((t,e)=>`input_${this._uniqueId}_all`)).property("checked",!0),e.append("label").attr("for",((t,e)=>`input_${this._uniqueId}_all`)).text(this._conf.promptText)}return this._cbox.selectAll("li.dc-cbox-item").sort(this._conf.order),this._cbox.on("change",(function(t,e){return i._onChange(e,t,this)})),e}_onChange(t,e,i){let s;let r;h.select(e.target).datum()?(r=h.select(i).selectAll("input").filter((function(t){if(t)return this.checked})),s=r.nodes().map((t=>t.value)),this._conf.multiple||1!==s.length||(s=s[0])):s=this._conf.promptValue||null,this.onChange(s)}onChange(t){t&&this._conf.multiple?this.replaceFilter([t]):t?this.replaceFilter(t):this.filterAll(),T.trigger((()=>{this.redrawGroup()}))}},t.ChartGroup=L,t.ColorCalculator=ht,t.ColorMixin=bt,t.ColorScaleHelper=lt,t.CompositeChart=Bt,t.Config=P,t.CoordinateGridMixin=St,t.DataCount=class extends xt{constructor(t,e){super(t,e),this.configure({formatNumber:s.format(",d"),html:{some:"",all:""}}),this._crossfilter=null,this._groupAll=null,this._mandatoryAttributes(["crossfilter","groupAll"])}configure(t){return super.configure(t),this}conf(){return this._conf}_doRender(){const t=this.crossfilter().size(),e=this.groupAll().value(),i=this._conf.formatNumber(t),s=this._conf.formatNumber(e);return t===e&&""!==this._conf.html.all?this.root().html(this._conf.html.all.replace("%total-count",i).replace("%filter-count",s)):""!==this._conf.html.some?this.root().html(this._conf.html.some.replace("%total-count",i).replace("%filter-count",s)):(this.selectAll(".total-count").text(i),this.selectAll(".filter-count").text(s)),this}_doRedraw(){return this._doRender()}crossfilter(t){return arguments.length?(this._crossfilter=t,this):this._crossfilter}groupAll(t){return arguments.length?(this._groupAll=t,this):this._groupAll}},t.DataGrid=class extends xt{constructor(t,e){super(t,e),this.configure({section:null,size:999,html:t=>`you need to provide an html() handling param:  ${JSON.stringify(t)}`,sortBy:t=>t,order:n.ascending,beginSlice:0,endSlice:void 0,htmlSection:t=>`<div class='dc-grid-section dc-grid-group'><h1 class='dc-grid-label'>${this._conf.keyAccessor(t)}</h1></div>`}),this._mandatoryAttributes(["dimension","section"])}configure(t){return super.configure(t),this}conf(){return this._conf}_doRender(){return this.selectAll("div.dc-grid-top").remove(),this._renderItems(this._renderSections()),this}_renderSections(){const t=this.root().selectAll("div.dc-grid-top").data(this._nestEntries(),(t=>this._conf.keyAccessor(t))),e=t.enter().append("div").attr("class",Et);return this._conf.htmlSection&&e.html((t=>this._conf.htmlSection(t))),t.exit().remove(),e}_nestEntries(){let t=this.dataProvider().conf().dimension.top(this._conf.size);return t=t.sort(((t,e)=>this._conf.order(this._conf.sortBy(t),this._conf.sortBy(e)))).slice(this._conf.beginSlice,this._conf.endSlice),n.groups(t,this._conf.section).sort(this._conf.order).map((t=>({key:`${t[0]}`,values:t[1]})))}_renderItems(t){let e=t.order().selectAll("div.dc-grid-item").data((t=>t.values));return e.exit().remove(),e=e.enter().append("div").attr("class",$t).html((t=>this._conf.html(t))).merge(e),e}_doRedraw(){return this._doRender()}},t.DataTable=class extends xt{constructor(t,e){super(t,e),this.configure({size:25,columns:[],sortBy:t=>t,order:n.ascending,beginSlice:0,endSlice:void 0,showSections:!0,section:()=>""}),this._mandatoryAttributes(["dimension"])}configure(t){return super.configure(t),this}conf(){return this._conf}_doRender(){return this.selectAll("tbody").remove(),this._renderRows(this._renderSections()),this}_doColumnValueFormat(t,e){return"function"==typeof t?t(e):"string"==typeof t?e[t]:t.format(e)}_doColumnHeaderFormat(t){return"function"==typeof t?this._doColumnHeaderFnToString(t):"string"==typeof t?this._doColumnHeaderCapitalize(t):String(t.label)}_doColumnHeaderCapitalize(t){return t.charAt(0).toUpperCase()+t.slice(1)}_doColumnHeaderFnToString(t){let e=String(t);const i=e.indexOf("return ");if(i>=0){const t=e.lastIndexOf(";");if(t>=0){e=e.substring(i+7,t);e.indexOf("numberFormat")>=0&&(e=e.replace("numberFormat",""))}}return e}_renderSections(){let t=!0;if(this._conf.columns.forEach((e=>{t=t&&"function"==typeof e})),!t){let t=this.selectAll("thead").data([0]);t.exit().remove(),t=t.enter().append("thead").merge(t);let e=t.selectAll("tr").data([0]);e.exit().remove(),e=e.enter().append("tr").merge(e);const i=e.selectAll("th").data(this._conf.columns);i.exit().remove(),i.enter().append("th").merge(i).attr("class","dc-table-head").html((t=>this._doColumnHeaderFormat(t)))}const e=this.root().selectAll("tbody").data(this._nestEntries(),(t=>this._conf.keyAccessor(t))),i=e.enter().append("tbody");return!0===this._conf.showSections&&i.append("tr").attr("class","dc-table-section dc-table-group").append("td").attr("class","dc-table-label").attr("colspan",this._conf.columns.length).html((t=>this._conf.keyAccessor(t))),e.exit().remove(),i}_nestEntries(){const t=this.dataProvider().conf().dimension;let e;return e=this._conf.order===n.ascending?t.bottom(this._conf.size):t.top(this._conf.size),e=e.sort(((t,e)=>this._conf.order(this._conf.sortBy(t),this._conf.sortBy(e)))).slice(this._conf.beginSlice,this._conf.endSlice),n.groups(e,this._conf.section).sort(this._conf.order).map((t=>({key:`${t[0]}`,values:t[1]})))}_renderRows(t){const e=t.order().selectAll("tr.dc-table-row").data((t=>t.values)),i=e.enter().append("tr").attr("class",Tt);return this._conf.columns.forEach(((t,e)=>{i.append("td").attr("class",`dc-table-column _${e}`).html((e=>this._doColumnValueFormat(t,e)))})),e.exit().remove(),e}_doRedraw(){return this._doRender()}},t.FilterHandler=gt,t.FilterStorage=S,t.GeoChoroplethChart=zt,t.HeatMap=Ht,t.HierarchyFilter=m,t.HtmlLegend=class{constructor(){this._htmlLegendDivCssClass="dc-html-legend",this._legendItemCssClassHorizontal="dc-legend-item-horizontal",this._legendItemCssClassVertical="dc-legend-item-vertical",this._parent=void 0,this._container=void 0,this._legendText=t=>t.name,this._maxItems=void 0,this._horizontal=!1,this._legendItemClass=void 0,this._highlightSelected=!1}parent(t){return arguments.length?(this._parent=t,this):this._parent}render(){const t=this._horizontal?this._legendItemCssClassHorizontal:this._legendItemCssClassVertical;this._container.select(`div.${this._htmlLegendDivCssClass}`).remove();const e=this._container.append("div").attr("class",this._htmlLegendDivCssClass);e.attr("style",`max-width:${this._container.nodes()[0].style.width}`);let i=this._parent.legendables();const s=this._parent.filters();void 0!==this._maxItems&&(i=i.slice(0,this._maxItems));const r=this._legendItemClass?this._legendItemClass:t,n=e.selectAll(`div.${r}`).data(i).enter().append("div").classed(r,!0).on("mouseover",((t,e)=>this._parent.legendHighlight(e))).on("mouseout",((t,e)=>this._parent.legendReset(e))).on("click",((t,e)=>this._parent.legendToggle(e)));this._highlightSelected&&n.classed(R.SELECTED_CLASS,(t=>-1!==s.indexOf(t.name))),n.append("span").attr("class","dc-legend-item-color").style("background-color",(t=>t.color)),n.append("span").attr("class","dc-legend-item-label").attr("title",this._legendText).text(this._legendText)}container(t){return arguments.length?(this._container=h.select(t),this):this._container}legendItemClass(t){return arguments.length?(this._legendItemClass=t,this):this._legendItemClass}highlightSelected(t){return arguments.length?(this._highlightSelected=t,this):this._highlightSelected}horizontal(t){return arguments.length?(this._horizontal=t,this):this._horizontal}legendText(t){return arguments.length?(this._legendText=t,this):this._legendText}maxItems(t){return arguments.length?(this._maxItems=W(t)?t:void 0,this):this._maxItems}},t.InvalidStateException=z,t.Legend=class{constructor(){this._parent=void 0,this._x=0,this._y=0,this._itemHeight=12,this._gap=5,this._horizontal=!1,this._legendWidth=560,this._itemWidth=70,this._autoItemWidth=!1,this._legendText=t=>t.name,this._maxItems=void 0,this._highlightSelected=!1,this._g=void 0}parent(t){return arguments.length?(this._parent=t,this):this._parent}x(t){return arguments.length?(this._x=t,this):this._x}y(t){return arguments.length?(this._y=t,this):this._y}gap(t){return arguments.length?(this._gap=t,this):this._gap}highlightSelected(t){return arguments.length?(this._highlightSelected=t,this):this._highlightSelected}itemHeight(t){return arguments.length?(this._itemHeight=t,this):this._itemHeight}horizontal(t){return arguments.length?(this._horizontal=t,this):this._horizontal}legendWidth(t){return arguments.length?(this._legendWidth=t,this):this._legendWidth}itemWidth(t){return arguments.length?(this._itemWidth=t,this):this._itemWidth}autoItemWidth(t){return arguments.length?(this._autoItemWidth=t,this):this._autoItemWidth}legendText(t){return arguments.length?(this._legendText=t,this):this._legendText}maxItems(t){return arguments.length?(this._maxItems=W(t)?t:void 0,this):this._maxItems}_legendItemHeight(){return this._gap+this._itemHeight}render(){this._parent.svg().select("g.dc-legend").remove(),this._g=this._parent.svg().append("g").attr("class","dc-legend").attr("transform",`translate(${this._x},${this._y})`);let t=this._parent.legendables();const e=this._parent.filters();void 0!==this._maxItems&&(t=t.slice(0,this._maxItems));const i=this._g.selectAll("g.dc-legend-item").data(t).enter().append("g").attr("class","dc-legend-item").on("mouseover",((t,e)=>{this._parent.legendHighlight(e)})).on("mouseout",((t,e)=>{this._parent.legendReset(e)})).on("click",((t,e)=>{e.chart.legendToggle(e)}));this._highlightSelected&&i.classed(R.SELECTED_CLASS,(t=>-1!==e.indexOf(t.name))),this._g.selectAll("g.dc-legend-item").classed("fadeout",(t=>t.chart.isLegendableHidden(t))),t.some((t=>t.dashstyle))?i.append("line").attr("x1",0).attr("y1",this._itemHeight/2).attr("x2",this._itemHeight).attr("y2",this._itemHeight/2).attr("stroke-width",2).attr("stroke-dasharray",(t=>t.dashstyle)).attr("stroke",(t=>t.color)):i.append("rect").attr("width",this._itemHeight).attr("height",this._itemHeight).attr("fill",(t=>t?t.color:"blue"));{const t=this;i.append("text").text(t._legendText).attr("x",t._itemHeight+2).attr("y",(function(){const e=this.getBoundingClientRect().height||13;return t._itemHeight/2+e/2-2}))}let s=0,r=0;{const t=this;i.attr("transform",(function(e,i){if(t._horizontal){const e=!0===t._autoItemWidth?this.getBBox().width+t._gap:t._itemWidth;s+e>t._legendWidth&&s>0&&(++r,s=0);const i=`translate(${s},${r*t._legendItemHeight()})`;return s+=e,i}return`translate(0,${i*t._legendItemHeight()})`}))}}},t.LineChart=Yt,t.LinearColors=ct,t.Logger=k,t.MarginMixin=vt,t.NumberDisplay=class extends xt{constructor(t,e){super(t,e),this.configure({transitionDuration:250,transitionDelay:0,formatNumber:s.format(".2s")}),this.dataProvider().configure({ordering:t=>t.value}),this._html={one:"",some:"",none:""},this._lastValue=void 0,this._mandatoryAttributes(["group"])}configure(t){return super.configure(t),this}conf(){return this._conf}data(){const t=this.dataProvider().conf().group,e=t.value?t.value():this._maxBin(t.all());return this.dataProvider().conf().valueAccessor(e)}html(t){return arguments.length?(t.none?this._html.none=t.none:t.one?this._html.none=t.one:t.some&&(this._html.none=t.some),t.one?this._html.one=t.one:t.some&&(this._html.one=t.some),t.some?this._html.some=t.some:t.one&&(this._html.some=t.one),this):this._html}value(){return this.data()}_maxBin(t){if(!t.length)return null;const e=this._computeOrderedGroups(t);return e[e.length-1]}_doRender(){const t=this.value();let e=this.selectAll(`.${It}`);e.empty()&&(e=e.data([0]).enter().append("span").attr("class",It).merge(e));{const i=this;e.transition().duration(i._conf.transitionDuration).delay(i._conf.transitionDelay).ease(p.easeQuad).tween("text",(function(){const e=isFinite(i._lastValue)?i._lastValue:0,s=o.interpolateNumber(e||0,t);i._lastValue=t;const r=this;return e=>{let n=null;const a=i._conf.formatNumber(s(e));0===t&&""!==i._html.none?n=i._html.none:1===t&&""!==i._html.one?n=i._html.one:""!==i._html.some&&(n=i._html.some),r.innerHTML=n?n.replace("%number",a):a}}))}return this}_doRedraw(){return this._doRender()}},t.OrdinalColors=dt,t.PieChart=Ut,t.RangedFilter=x,t.RangedTwoDimensionalFilter=A,t.RowChart=Vt,t.ScatterPlot=class extends St{constructor(t,e){super(t,e);const i=this._conf.keyAccessor;this.configure({keyAccessor:t=>i(t)[0],colorAccessor:()=>this.dataProvider().conf().groupName,existenceAccessor:t=>t.value,title:t=>`${this._conf.keyAccessor(t)},${t._value}: ${this._conf.existenceAccessor(t)}`,highlightedSize:7,symbolSize:5,excludedSize:3,excludedColor:null,excludedOpacity:1,emptySize:0,emptyOpacity:0,nonemptyOpacity:1,emptyColor:null,useCanvas:!1}),this.dataProvider().configure({valueAccessor:t=>i(t)[1]}),this._symbol=f.symbol(),this._filtered=[],this._canvas=null,this._context=null,this.brush(u.brush()),this._symbol.size(((t,e)=>this._elementSize(t,e)))}configure(t){return super.configure(t),this}conf(){return this._conf}_canvasElementSize(t,e){return this._conf.existenceAccessor(t)?e?this._conf.symbolSize/Math.sqrt(Math.PI):this._conf.excludedSize/Math.sqrt(Math.PI):this._conf.emptySize/Math.sqrt(Math.PI)}_elementSize(t,e){return this._conf.existenceAccessor(t)?this._filtered[e]?Math.pow(this._conf.symbolSize,2):Math.pow(this._conf.excludedSize,2):Math.pow(this._conf.emptySize,2)}_locator(t){return`translate(${this.x()(this._conf.keyAccessor(t))},${this.y()(t._value)})`}filter(t){return arguments.length?null===t?super.filter(null):super.filter(new A(t)):super.filter()}resetSvg(){if(this._conf.useCanvas){super.resetSvg(),this.select("canvas").remove();const t=this.svg();this.root().style("position","relative"),t.style("position","relative");const e=isNaN(parseInt(t.style("left"),10))?0:parseInt(t.style("left"),10),i=isNaN(parseInt(t.style("top"),10))?0:parseInt(t.style("top"),10),s=this.effectiveWidth(),r=this.effectiveHeight(),n=this.margins(),a=window.devicePixelRatio||1;return this._canvas=this.root().append("canvas").attr("x",0).attr("y",0).attr("width",s*a).attr("height",r*a).style("width",`${s}px`).style("height",`${r}px`).style("position","absolute").style("top",`${n.top+i}px`).style("left",`${n.left+e}px`).style("z-index",-1).style("pointer-events","none"),this._context=this._canvas.node().getContext("2d"),this._context.scale(a,a),this._context.rect(0,0,s,r),this._context.clip(),this._context.imageSmoothingQuality="high",this.svg()}return super.resetSvg()}_resizeCanvas(){const t=this.effectiveWidth(),e=this.effectiveHeight(),i=window.devicePixelRatio||1;this._canvas.attr("width",t*i).attr("height",e*i).style("width",`${t}px`).style("height",`${e}px`),this._context.scale(i,i)}canvas(t){return arguments.length?(this._canvas=t,this):this._canvas}context(){return this._context}_plotOnCanvas(t){this._resizeCanvas();const e=this.context();e.clearRect(0,0,e.canvas.width+2,e.canvas.height+2);this.data().forEach(((i,s)=>{const r=!this.filter()||this.filter().isFiltered([i.key[0],i.key[1]]);let n=1;n=this._conf.existenceAccessor(i)?r?this._conf.nonemptyOpacity:this._conf.excludedOpacity:this._conf.emptyOpacity;let a=null;a=this._conf.emptyColor&&!this._conf.existenceAccessor(i)?this._conf.emptyColor:this._conf.excludedColor&&!r?this._conf.excludedColor:this._colorHelper.getColor(i,void 0);let o=this._canvasElementSize(i,r);if(t){const e=a===t.color,i=.1;e||(n=i),e&&(o=this._conf.highlightedSize/Math.sqrt(Math.PI))}e.save(),e.globalAlpha=n,e.beginPath(),e.arc(this.x()(this._conf.keyAccessor(i)),this.y()(i._value),o,0,2*Math.PI,!0),e.fillStyle=a,e.fill(),e.restore()}))}_plotOnSVG(){let t=this.chartBodyG().selectAll("path.symbol").data(this.data());B(t.exit(),this._conf.transitionDuration,this._conf.transitionDelay).attr("opacity",0).remove(),t=t.enter().append("path").attr("class","symbol").attr("opacity",0).attr("fill",((t,e)=>this._colorHelper.getColor(t,e))).attr("transform",(t=>this._locator(t))).merge(t),t.call((t=>this._renderTitles(t,this.data()))),t.each(((t,e)=>{this._filtered[e]=!this.filter()||this.filter().isFiltered([this._conf.keyAccessor(t),t._value])})),B(t,this._conf.transitionDuration,this._conf.transitionDelay).attr("opacity",((t,e)=>this._conf.existenceAccessor(t)?this._filtered[e]?this._conf.nonemptyOpacity:this._conf.excludedOpacity:this._conf.emptyOpacity)).attr("fill",((t,e)=>this._conf.emptyColor&&!this._conf.existenceAccessor(t)?this._conf.emptyColor:this._conf.excludedColor&&!this._filtered[e]?this._conf.excludedColor:this._colorHelper.getColor(t,void 0))).attr("transform",(t=>this._locator(t))).attr("d",this._symbol)}plotData(){this._conf.useCanvas?this._plotOnCanvas():this._plotOnSVG()}_renderTitles(t,e){this._conf.renderTitle&&(t.selectAll("title").remove(),t.append("title").text((t=>this._conf.title(t))))}symbol(t){return arguments.length?(this._symbol.type(t),this):this._symbol.type()}customSymbol(t){return arguments.length?(this._symbol=t,this._symbol.size(((t,e)=>this._elementSize(t,e))),this):this._symbol}legendables(){return[{chart:this,name:this.dataProvider().conf().groupName,color:this._colorHelper.getColor(this.dataProvider().conf().groupName,void 0)}]}legendHighlight(t){this._conf.useCanvas?this._plotOnCanvas(t):(this._resizeSymbolsWhere((e=>e.attr("fill")===t.color),this._conf.highlightedSize),this.chartBodyG().selectAll(".chart-body path.symbol").filter((function(){return h.select(this).attr("fill")!==t.color})).classed("fadeout",!0))}legendReset(t){this._conf.useCanvas?this._plotOnCanvas(t):(this._resizeSymbolsWhere((e=>e.attr("fill")===t.color),this._conf.symbolSize),this.chartBodyG().selectAll(".chart-body path.symbol").filter((function(){return h.select(this).attr("fill")!==t.color})).classed("fadeout",!1))}_resizeSymbolsWhere(t,e){const i=this.chartBodyG().selectAll(".chart-body path.symbol").filter((function(){return t(h.select(this))})),s=this._symbol.size();this._symbol.size(Math.pow(e,2)),B(i,this._conf.transitionDuration,this._conf.transitionDelay).attr("d",this._symbol),this._symbol.size(s)}_createBrushHandlePaths(){}_extendBrush(t){return this._conf.round&&(t[0]=t[0].map(this._conf.round),t[1]=t[1].map(this._conf.round)),t}_brushIsEmpty(t){return!t||t[0][0]>=t[1][0]||t[0][1]>=t[1][1]}_brushing(t){if(this._ignoreBrushEvents)return;let e=t.selection,i=this._brushIsEmpty(e);e&&(e=e.map((t=>t.map(((t,e)=>(0===e?this.x():this.y()).invert(t))))),e=this._extendBrush(e),i=i&&this._brushIsEmpty(e)),this._redrawBrush(e,!1);const s=i?null:new A(e);T.trigger((()=>{this.replaceFilter(s),this.redrawGroup()}),R.EVENT_DELAY)}_redrawBrush(t,e){const i=this._gBrush;if(this._conf.brushOn&&i)if(this.resizing()&&this._setBrushExtents(e),t){t=t.map((t=>t.map(((t,e)=>(0===e?this.x():this.y())(t)))));const s=$(e,this._conf.transitionDuration,this._conf.transitionDelay)(i);this._withoutBrushEvents((()=>{s.call(this.brush().move,t)}))}else this._withoutBrushEvents((()=>{i.call(this.brush().move,t)}));this.fadeDeselectedArea(t)}},t.SelectMenu=class extends xt{constructor(t,e){super(t,e),this.configure({multiple:!1,promptText:"Select all",promptValue:null,filterDisplayed:t=>t._value>0,order:(t,e)=>n.ascending(this._conf.keyAccessor(t),this._conf.keyAccessor(e)),numberVisible:null}),this._select=void 0}configure(t){return super.configure(t),this}conf(){return this._conf}data(){return super.data().filter(this._conf.filterDisplayed)}_doRender(){return this.select("select").remove(),this._select=this.root().append("select").classed("dc-select-menu",!0),this._select.append("option").text(this._conf.promptText).attr("value",""),this._doRedraw(),this}_doRedraw(){return this._setAttributes(),this._renderOptions(),this.hasFilter()&&this._conf.multiple?this._select.selectAll("option").property("selected",(t=>void 0!==t&&this.filters().indexOf(String(this._conf.keyAccessor(t)))>=0)):this.hasFilter()?this._select.property("value",this.filter()):this._select.property("value",""),this}_renderOptions(){const t=this._select.selectAll("option.dc-select-option").data(this.data(),(t=>this._conf.keyAccessor(t)));t.exit().remove(),t.enter().append("option").classed(Xt,!0).attr("value",(t=>this._conf.keyAccessor(t))).merge(t).text(this._conf.title),this._select.selectAll("option.dc-select-option").sort(this._conf.order),this._select.on("change",((t,e)=>this._onChange(e,t)))}_onChange(t,e){let i;const s=e.target;if(s.selectedOptions){i=Array.prototype.slice.call(s.selectedOptions).map((t=>t.value))}else{i=[].slice.call(e.target.options).filter((t=>t.selected)).map((t=>t.value))}1===i.length&&""===i[0]?i=this._conf.promptValue||null:this._conf.multiple||1!==i.length||(i=i[0]),this.onChange(i)}onChange(t){t&&this._conf.multiple?this.replaceFilter([t]):t?this.replaceFilter(t):this.filterAll(),T.trigger((()=>{this.redrawGroup()}))}_setAttributes(){this._conf.multiple?this._select.attr("multiple",!0):this._select.attr("multiple",null),null!==this._conf.numberVisible?this._select.attr("size",this._conf.numberVisible):this._select.attr("size",null)}},t.SeriesChart=class extends Bt{constructor(t,e){super(t,e),this._charts={},this.configure({shareColors:!0,chartFunction:(t,e)=>new Yt(t,e),seriesAccessor:void 0,seriesSort:n.ascending,valueSort:(t,e)=>n.ascending(this._conf.keyAccessor(t),this._conf.keyAccessor(e))}),this._mandatoryAttributes().push("seriesAccessor","chart")}configure(t){return super.configure(t),["chartFunction","seriesAccessor","seriesSort","valueSort"].some((e=>e in t))&&this._resetChildren(),this}conf(){return this._conf}_compose(t){super.compose(t)}compose(t){throw new Error("Not supported for this chart type")}_preprocessData(){const t=[];let e,i=[...this.data()].sort(this._conf.valueSort);const s=n.groups(i,this._conf.seriesAccessor).sort(this._conf.seriesSort).map((t=>({key:`${t[0]}`,values:t[1]}))).map(((i,s)=>{const r=this._charts[i.key]||this._conf.chartFunction(this,this.chartGroup());return this._charts[i.key]||(e=!0),this._charts[i.key]=r,t.push(i.key),r.dataProvider().configure({dimension:this.dataProvider().conf().dimension,valueAccessor:this.dataProvider().conf().valueAccessor,groupName:i.key,group:{all:"function"==typeof i.values?i.values:()=>i.values}}),r.configure({keyAccessor:this._conf.keyAccessor}),r.configure({brushOn:!1})}));Object.keys(this._charts).filter((e=>-1===t.indexOf(e))).forEach((t=>{this._clearChart(t),e=!0})),this._compose(s),e&&this.legend()&&this.legend().render()}_clearChart(t){this._charts[t].g()&&this._charts[t].g().remove(),delete this._charts[t]}_resetChildren(){Object.keys(this._charts).map(this._clearChart),this._charts={}}},t.StackMixin=Rt,t.SunburstChart=qt,t.TextFilterWidget=class extends xt{constructor(t,e){super(t,e),this.configure({placeHolder:"search",normalize:t=>t.toLowerCase(),filterFunctionFactory:t=>(t=this._conf.normalize(t),e=>-1!==this._conf.normalize(e).indexOf(t))})}configure(t){return super.configure(t),this}conf(){return this._conf}_doRender(){this.select("input").remove(),this._input=this.root().append("input").classed("dc-text-filter-input",!0);const t=this;return this._input.on("input",(function(){t.dataProvider().conf().dimension.filterFunction(t._conf.filterFunctionFactory(this.value)),T.trigger((()=>{t.redrawGroup()}),R.EVENT_DELAY)})),this._doRedraw(),this}_doRedraw(){return this.root().selectAll("input").attr("placeholder",this._conf.placeHolder),this}},t.TwoDimensionalFilter=b,t.UnitWithPrecision=function(t){const e=function(t,i){const s=Math.abs((i-t)/e.resolution);return X(s-Math.floor(s))?Math.floor(s):Math.ceil(s)};return e.resolution=t,e},t.UnitsInteger=nt,t.UnitsOrdinal=at,t.add=Y,t.afterTransition=function(t,e){if(t.empty()||!t.duration)e.call(t);else{let i=0;t.each((()=>{++i})).on("end",(()=>{--i||e.call(t)}))}},t.allChildren=function t(e){let i=[];if(i.push(e.path),console.log("currentNode",e),e.children)for(let s=0;s<e.children.length;s++)i=i.concat(t(e.children[s]));return i},t.appendOrSelect=K,t.arraysEqual=Q,t.arraysIdentical=it,t.chartRegistry=D,t.clamp=function(t,e,i){return t<e?e:t>i?i:t},t.config=O,t.constants=R,t.d3Box=_t,t.events=T,t.getAncestors=function(t){const e=[];let i=t;for(;i.parent;)e.unshift(i.name),i=i.parent;return e},t.instanceOfChart=E,t.isFloat=U,t.isInteger=V,t.isNegligible=X,t.isNumber=W,t.logger=F,t.nameToId=Z,t.optionalTransition=$,t.pluck2=H,t.printFilter=rt,t.printFilters=st,t.printSingleValue=N,t.safeNumber=J,t.sortBy=M,t.subtract=I,t.toHierarchy=tt,t.transition=B,t.uniqueId=j,t.version="5.0.0-alpha0",Object.defineProperty(t,"__esModule",{value:!0})}));
//# sourceMappingURL=dc.min.js.map
